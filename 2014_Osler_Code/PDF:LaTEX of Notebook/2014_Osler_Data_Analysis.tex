
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass{article}

    
    \usepackage{booktabs}
    \usepackage{moresize}
    \usepackage{caption}
    \usepackage{graphicx} % Used to insert images
    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{color} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    

    
    
    \definecolor{orange}{cmyk}{0,0.4,0.8,0.2}
    \definecolor{darkorange}{rgb}{.71,0.21,0.01}
    \definecolor{darkgreen}{rgb}{.12,.54,.11}
    \definecolor{myteal}{rgb}{.26, .44, .56}
    \definecolor{gray}{gray}{0.45}
    \definecolor{lightgray}{gray}{.95}
    \definecolor{mediumgray}{gray}{.8}
    \definecolor{inputbackground}{rgb}{.95, .95, .85}
    \definecolor{outputbackground}{rgb}{.95, .95, .95}
    \definecolor{traceback}{rgb}{1, .95, .95}
    % ansi colors
    \definecolor{red}{rgb}{.6,0,0}
    \definecolor{green}{rgb}{0,.65,0}
    \definecolor{brown}{rgb}{0.6,0.6,0}
    \definecolor{blue}{rgb}{0,.145,.698}
    \definecolor{purple}{rgb}{.698,.145,.698}
    \definecolor{cyan}{rgb}{0,.698,.698}
    \definecolor{lightgray}{gray}{0.5}
    
    % bright ansi colors
    \definecolor{darkgray}{gray}{0.25}
    \definecolor{lightred}{rgb}{1.0,0.39,0.28}
    \definecolor{lightgreen}{rgb}{0.48,0.99,0.0}
    \definecolor{lightblue}{rgb}{0.53,0.81,0.92}
    \definecolor{lightpurple}{rgb}{0.87,0.63,0.87}
    \definecolor{lightcyan}{rgb}{0.5,1.0,0.83}
    
    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Supporting Materials for Confirmation of progressive plate motion during the Midcontinent Riftâ€™s early magmatic stage from the Osler Volcanic Group, Ontario, Canada}
    \date{}
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=blue,
      linkcolor=darkorange,
      citecolor=darkgreen,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    \vspace{-.7 in}
    \noindent Corresponding Author: Nicholas L. Swanson-Hysell
(swanson-hysell@berkeley.edu)
    {\small \tableofcontents}
    

    





    \section{Introduction}


    This IPython notebook contains data analysis on paleomagnetic data
developed from ca. 1.1 billion year old lava flows of the Osler Volcanic
Group that are part of the North American Midcontinent Rift as well as
supporting analyses on other data sets. These analyses accompany a
\textbf{Geochemistry, Geophysics, Geosystems} manuscript entitled
``Confirmation of progressive plate motion during the Midcontinent
Rift's early magmatic stage from the Osler Volcanic Group, Ontario,
Canada'' by N. L. Swanson-Hysell, A. A. Vaughan, M. R. Mustain and K.
Asp. This notebook is part of the supporting online materials and is
available at
\url{https://github.com/Swanson-Hysell/2014_Swanson-Hysell-et-al_Osler}
along with the necessary files to execute all of the code. Within this
github repository are the following folders:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\itemsep1pt\parskip0pt\parsep0pt
\item
  \href{https://github.com/Swanson-Hysell/2014_Swanson-Hysell-et-al_Osler/tree/master/2014_Osler_Code}{2014\_Osler\_Code}
  This folder contains this notebook file as well as necessary
  libraries.
\item
  \href{https://github.com/Swanson-Hysell/2014_Swanson-Hysell-et-al_Osler/tree/master/2014_Osler_Data}{2014\_Osler\_Data}
  This folder contains the data generated in the study at the specimen
  level as well as the flow means that are imported into this notebook
  for data analysis.
\item
  \href{https://github.com/Swanson-Hysell/2014_Swanson-Hysell-et-al_Osler/tree/master/2014_Osler_Manuscript}{2014\_Osler\_Manuscript}
  This folder contains the manuscript text and figures.
\end{enumerate}

If you are viewing this supporting material as a PDF document and want
to run the code in the notebook you will need to download the code from
the github repository and you will also need a Python distribution that
includes IPython. There are good instructions for installing IPython
here: http://ipython.org/install.html. Alternatively you can view the
notebook online with the IPython nbviewer at this link:
http://bit.ly/19XRdjJ


    \section{Import libraries}


    This code blocks imports necessary libraries that define functions that
will be used in the data analysis below. The code below uses the pmag.py
and pmagplotlib.py files of the the PmagPy software package (version
pmagpy-2.206) authored by Lisa Tauxe (https://github.com/ltauxe/PmagPy).
The check\_updates and get\_version functions of the PmagPy libraries
cause errors in the interactive environment of IPython so the code below
calls a slightly modified version of those libraries that is included in
the Github repository for this work. There are other functions that are
necessary for the interactive plotting of paleomagnetic data (some of
them edited from PmagPy) that are within the IPmag.py library that is
imported in the code block below.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c}{\PYZsh{}import paleomagnetic specific libraries}
        \PY{k+kn}{import} \PY{n+nn}{pmag}\PY{o}{,} \PY{n+nn}{pmagplotlib}\PY{o}{,} \PY{n+nn}{IPmag}
        \PY{k+kn}{import} \PY{n+nn}{pandas}
        \PY{n}{pandas}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{display.max\PYZus{}columns}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{)}
        \PY{k+kn}{from} \PY{n+nn}{IPython.core.display} \PY{k+kn}{import} \PY{n}{HTML}
        \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits.basemap} \PY{k+kn}{import} \PY{n}{Basemap}
\end{Verbatim}

    This notebook runs with pylab inline which imports the numpy, scipy and
matplotlib functions and allows for the plots to be viewed inline in the
IPython notebook (instead of opening up in another window).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{o}{\PYZpc{}}\PY{k}{pylab} \PY{n}{inline}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Populating the interactive namespace from numpy and matplotlib
    \end{Verbatim}


    \section{Import Simpson Island paleomagnetic data}


    The data file FlowDataAll.csv has data in this format:

SITE, STRAT\_HEIGHT, DEC\_GEO, INC\_GEO, Dec\_TC, INC\_TC, A95, n, Plat,
ABS\_Plat, VGP\_lat, VGP\_long

where:

\textbf{SITE} is the name of the site and corresponds to an individual
lava flow where in the first part of the site name (e.g.~SI1)
corresponds to the name of a stratigraphic section while the second part
(e.g. (11.8 to 26.4)) corresponds to the stratigraphic ranges within the
measured section over which the flows is exposed.

\textbf{STRAT\_HEIGHT} is the cumulative stratigraphic height of the
Simpson Island stratigraphy starting with the base of the SI1 section
(see map in the main manuscript).

\textbf{DEC\_GEO} is the site mean declination in geographic (i.e.
\emph{in situ}) coordinates prior to tilt-correction.

\textbf{INC\_GEO} is the site mean inclination in geographic (i.e.
\emph{in situ}) coordinates prior to tilt-correction.

\textbf{Dec\_TC} is the site mean declination in tilt-corrected
coordinates following correction for bedding tilt.

\textbf{INC\_TC} is the site mean inclination in tilt-corrected
coordinates following correction for bedding tilt.

\textbf{A95} is the 95$\%$ Fisher confidence ellipse around the
calculated site mean.

\textbf{n} is the number of individually oriented samples that are being
included to calculate the site mean.

\textbf{Plat} is the paleolatitude calculated from the site mean using
the dipole equation.

\textbf{ABS\_Plat} is the absolute value of this paleolatitude.

\textbf{VGP\_lat} is the latitude of the virtual geomagnetic pole
calculated using the site location and the site mean direction.

\textbf{VGP\_long} is the longitude of the virtual geomagnetic pole
calculated using the site location and the site mean direction.

These data are displayed in a table below and imported by variable in
the cell below the table.


    \subsection{Table of Simpson Island paleomagnetic data}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{data} \PY{o}{=} \PY{n}{pandas}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{../2014\PYZus{}Osler\PYZus{}Data/SimpsonIsland\PYZus{}OslerData.csv}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{c}{\PYZsh{}write these data to a latex file for the supplemental PDF}
        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{OslerData.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{w}\PY{l+s}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
            \PY{n}{f}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}latex}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Site}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Strat\PYZus{}Height}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Site\PYZus{}Lat}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Site\PYZus{}Long}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Dec\PYZus{}Geo}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Inc\PYZus{}Geo}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Dec\PYZus{}TC}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Inc\PYZus{}TC}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{n}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{VGP\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{VGP\PYZus{}long}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n}{display}\PY{p}{(}\PY{n}{HTML}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}html}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    
\clearpage
\begin{table}[!h]
\caption*{Simpson Island paleomagnetic site mean data}
\ssmall
\input{OslerData.txt}
\end{table}

    
    The .csv of these data can be downloaded here:
\href{https://github.com/Swanson-Hysell/2014_Swanson-Hysell-et-al_Osler/tree/master/2014_Osler_Data}{SimpsonIsland\_OslerData.csv}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{data\PYZus{}file}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{../2014\PYZus{}Osler\PYZus{}Data/SimpsonIsland\PYZus{}OslerData.csv}\PY{l+s}{\PYZsq{}}
        \PY{n}{SimpsonIsland\PYZus{}Strat} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{genfromtxt}\PY{p}{(}\PY{n}{data\PYZus{}file}\PY{p}{,}\PY{n}{delimiter}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{,}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{skip\PYZus{}header}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{strat\PYZus{}height}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{Dec\PYZus{}TC}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}
        \PY{n}{Inc\PYZus{}TC}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{]}
        \PY{n}{A95}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{]}
        \PY{n}{plat}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}
        \PY{n}{abs\PYZus{}plat}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{]}
        \PY{n}{VGP\PYZus{}lat}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{]}
        \PY{n}{VGP\PYZus{}long}\PY{o}{=}\PY{n}{SimpsonIsland\PYZus{}Strat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{]}
\end{Verbatim}


    \section{Comparison between data from the lower 1/3, middle 1/3 and upper 1/3 of
Simpson Island stratigraphy}


    Let's consider the data by stratigraphically grouping flow data from the
lower third (0 to 1041 meters), middle third (1041 to 2083 meters) and
the upper third (2083 to 3124 meters) of the stratigraphy. The Fisher
means for these groups are calculated with the resulting dictionaries
from the fisher\_mean pmag.py fuction being printed below and with the
data being displayed on equal area plots with the calculated Fisher
means also being plotted.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{SI\PYZus{}Directions}\PY{o}{=}\PY{p}{[}\PY{p}{]}
        \PY{n}{SI\PYZus{}Poles}\PY{o}{=}\PY{p}{[}\PY{p}{]}
        
        \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{84}\PY{p}{)}\PY{p}{:}
            \PY{n}{Dec}\PY{p}{,}\PY{n}{Inc}\PY{o}{=}\PY{n}{Dec\PYZus{}TC}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{Inc\PYZus{}TC}\PY{p}{[}\PY{n}{n}\PY{p}{]} 
            \PY{n}{SI\PYZus{}Directions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{Dec}\PY{p}{,}\PY{n}{Inc}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
            \PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{o}{=}\PY{n}{VGP\PYZus{}long}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{VGP\PYZus{}lat}\PY{p}{[}\PY{n}{n}\PY{p}{]}
            \PY{n}{SI\PYZus{}Poles}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
            
        \PY{n}{SI\PYZus{}LowerThird\PYZus{}Directions}\PY{o}{=}\PY{n}{SI\PYZus{}Directions}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}
        \PY{n}{SI\PYZus{}LowerThird\PYZus{}Poles}\PY{o}{=}\PY{n}{SI\PYZus{}Poles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}
        \PY{n}{SI\PYZus{}MiddleThird\PYZus{}Directions}\PY{o}{=}\PY{n}{SI\PYZus{}Directions}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}
        \PY{n}{SI\PYZus{}MiddleThird\PYZus{}Poles}\PY{o}{=}\PY{n}{SI\PYZus{}Poles}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}
        \PY{n}{SI\PYZus{}UpperThird\PYZus{}Directions}\PY{o}{=}\PY{n}{SI\PYZus{}Directions}\PY{p}{[}\PY{l+m+mi}{50}\PY{p}{:}\PY{l+m+mi}{84}\PY{p}{]}
        \PY{n}{SI\PYZus{}UpperThird\PYZus{}Poles}\PY{o}{=}\PY{n}{SI\PYZus{}Poles}\PY{p}{[}\PY{l+m+mi}{50}\PY{p}{:}\PY{l+m+mi}{84}\PY{p}{]}
        
        \PY{c}{\PYZsh{}calculate and display the Fisher means for each subset of the directions}
        \PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Directions}\PY{p}{)}
        \PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}Directions}\PY{p}{)}
        \PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Directions}\PY{p}{)}
        
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for SI\PYZus{}LowerThird\PYZus{}Directions are: }\PY{l+s}{\PYZsq{}}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Dec = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Inc = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for SI\PYZus{}MiddleThird\PYZus{}Directions are: }\PY{l+s}{\PYZsq{}}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Dec = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Inc = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for SI\PYZus{}UpperThird\PYZus{}Directions are: }\PY{l+s}{\PYZsq{}}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Dec = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Inc = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        
        \PY{c}{\PYZsh{}plot the direction of each flow mean on an equal area plot}
        \PY{n}{fignum} \PY{o}{=} \PY{l+m+mi}{1}
        \PY{n}{pylab}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{num}\PY{o}{=}\PY{n}{fignum}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{160}\PY{p}{)}
        \PY{n}{pmagplotlib}\PY{o}{.}\PY{n}{plotNET}\PY{p}{(}\PY{n}{fignum}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iplotDI}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Directions}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iplotDI}\PY{p}{(}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}Directions}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{y}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iplotDI}\PY{p}{(}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Directions}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{b}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Directional data from Simpson Island lava flows:}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        
        \PY{c}{\PYZsh{}plot the group means and a95 ellipses on same equal area plot}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iplotDImean}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
                    \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{s}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lower third}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iplotDImean}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
                    \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{y}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{s}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{middle third}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iplotDImean}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
                    \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{b}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{s}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{upper third}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The Fisher mean parameters for SI\_LowerThird\_Directions are: 
Dec = 99.3387210946 Inc = -68.0428839022
alpha95 = 3.358896873 k= 62.2034940674

The Fisher mean parameters for SI\_MiddleThird\_Directions are: 
Dec = 105.906122722 Inc = -64.89830144
alpha95 = 5.47951200533 k= 36.4544611363

The Fisher mean parameters for SI\_UpperThird\_Directions are: 
Dec = 107.624499973 Inc = -61.552568869
alpha95 = 3.51420656821 k= 50.020994936
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_17_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsection{Test for a common mean between paleomagnetic data from the lower, middle
and upper thirds of the stratigraphy}


    The code below will compare the subsets of data using these two
statistical tests:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\itemsep1pt\parskip0pt\parsep0pt
\item
  The $V_w$ test of Watson (1983) slightly modified from the
  implementation of PmagPy (Tauxe, 2013). The test is comprised of
  calculating the $V_w$ statistic for the two data sets and then
  determining the critical value of $V_w$ through a Monte Carlo
  simulation. For the simulation, two Fisher-distributed data sets with
  a common mean are simulated using their precisions ($k_1$ and $k_2$)
  and the number of points ($N_1$ and $N_2$) of the datasets being
  evaluated. Then the $V_w$ statistic that comes from comparison between
  the two simulated data sets is calculated. A large number of
  simulations are done (default is 1000; it can be set as the NumSims
  parameter of the function) in order to determine the $V_w$ values that
  would result by chance through sampling distributions with the same
  direction. The critical value of $V_w$ is at the 95\% level of
  confidence (i.e.~if 1000 $V_w$ values are simulated, it is the 950th
  one). This implementation of the test also provides the critical angle
  between the two sample mean directions and the corresponding McFadden
  and McElhinny (1990) classification.
\item
  The bootstrap fold test of Tauxe (developed by Tauxe et al., 1991 and
  implemented per Tauxe (2010)). This approach determines the cumulative
  distributions of the Cartesian coordinates of bootstrapped means and
  compares the cumulative distributions to see if the confidence
  intervals overlap. If they do all overlap, then the two means cannot
  be distinguished at the 95\% level of confidence and they pass the
  bootstrap test for a common mean. Otherwise, if the two sets of
  directions are distinct in the X, Y or Z component the two means can
  be distinguished at the 95\% confidence level.
\end{enumerate}


    \subsubsection{Common mean tests between SI\_LowerThird\_Directions and
SI\_MiddleThird\_Directions:}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}Directions}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}Directions}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           2.6
Critical value of V:  6.2
"Pass": Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M\&M1990 classification:

Angle between data set means: 4.1
Critical angle for M\&M1990:   6.3
The McFadden and McElhinny (1990) classification for
this test is: 'B'

===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_21_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_21_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsubsection{Common mean tests between SI\_MiddleThird\_Directions and
SI\_UpperThird\_Directions:}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Directions}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Directions}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           1.8
Critical value of V:  6.2
"Pass": Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M\&M1990 classification:

Angle between data set means: 3.4
Critical angle for M\&M1990:   6.4
The McFadden and McElhinny (1990) classification for
this test is: 'B'

===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_23_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_23_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_23_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsubsection{Common mean tests between SI\_LowerThird\_Directions and
SI\_UpperThird\_Directions:}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Directions}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Directions}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           14.5
Critical value of V:  6.0
"Fail": Since V is greater than Vcrit, the two means can
be distinguished at the 95\% confidence level.

M\&M1990 classification:

Angle between data set means: 7.4
Critical angle for M\&M1990:   4.8


===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_25_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_25_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsubsection{Common mean test on directions results summary}


    The above results from common mean statistical tests show that the
directions from the lower third cannot be distinguished as being
obtained from a distribution distinct from that of the middle third nor
can the directions from the upper third be distinguished from those of
the middle third. In contrast, directions from the lower third of the
stratigraphy can be distinguished from those of upper third at the 95\%
confidence level.


    \subsubsection{Common mean tests between SI\_LowerThird\_Poles and
SI\_UpperThird\_Poles:}


    For completeness, let's also conduct tests for a common mean between the
virtual geomagnetic poles (VGPs) from the lower third and upper third of
the stratigraphy in addition to the tests on the site mean directions in
directional space (declination, inclination).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Poles}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Poles}\PY{p}{)}
        \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Poles}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Poles}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           13.6
Critical value of V:  6.1
"Fail": Since V is greater than Vcrit, the two means can
be distinguished at the 95\% confidence level.

M\&M1990 classification:

Angle between data set means: 10.0
Critical angle for M\&M1990:   6.7


===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_30_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_30_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_30_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    As when the site declinations and inclinations are considered, the
virtual geomagnetic poles from the lower third and upper third of the
stratigraphy can be distibuguished at the 95\% confidence level
according to these tests.


    \subsection{Plotting the data stratigraphically}


    Using the flow means calculated for each portion of the stratigraphy,
the paleolatitude and 95\% confidence bounds on paleolatitude can be
calculated. The stratigraphic bounds (y-axis error bars) and
paleolatitude bounds (x-axis error bars) are displayed for points
plotted in the middle of the stratigraphic bin and at the mean
paleolatitude.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{SI\PYZus{}LowerThird\PYZus{}plat}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{SI\PYZus{}LowerThird\PYZus{}plat\PYZus{}max}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}
                                                            \PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{SI\PYZus{}LowerThird\PYZus{}plat\PYZus{}min}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{+}
                                                            \PY{n}{lower\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat\PYZus{}max}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}
                                                             \PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat\PYZus{}min}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{+}
                                                             \PY{n}{middle\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{SI\PYZus{}UpperThird\PYZus{}plat}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{SI\PYZus{}UpperThird\PYZus{}plat\PYZus{}max}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}
                                                            \PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{SI\PYZus{}UpperThird\PYZus{}plat\PYZus{}min}\PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{IPmag}\PY{o}{.}\PY{n}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{+}
                                                            \PY{n}{upper\PYZus{}third\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{SI\PYZus{}LowerThird\PYZus{}meanstrat}\PY{o}{=}\PY{l+m+mi}{521}
         \PY{n}{SI\PYZus{}MiddleThird\PYZus{}meanstrat}\PY{o}{=}\PY{l+m+mi}{521}\PY{o}{+}\PY{l+m+mi}{1041}
         \PY{n}{SI\PYZus{}UpperThird\PYZus{}meanstrat}\PY{o}{=}\PY{l+m+mi}{521}\PY{o}{+}\PY{l+m+mi}{1041}\PY{o}{+}\PY{l+m+mi}{1041}
         
         \PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{n}{errorbar}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}plat}\PY{p}{,} \PY{n}{SI\PYZus{}LowerThird\PYZus{}meanstrat}\PY{p}{,} \PY{n}{yerr}\PY{o}{=}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{521}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{521}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                  \PY{n}{xerr}\PY{o}{=}\PY{p}{[}\PY{p}{[}\PY{n}{SI\PYZus{}LowerThird\PYZus{}plat}\PY{o}{\PYZhy{}}\PY{n}{SI\PYZus{}LowerThird\PYZus{}plat\PYZus{}min}\PY{p}{]}\PY{p}{,}
                        \PY{p}{[}\PY{n}{SI\PYZus{}LowerThird\PYZus{}plat\PYZus{}max}\PY{o}{\PYZhy{}}\PY{n}{SI\PYZus{}LowerThird\PYZus{}plat}\PY{p}{]}\PY{p}{]}\PY{p}{,} 
                  \PY{n}{fmt}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ro}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{lower third (N=30)}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{errorbar}\PY{p}{(}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat}\PY{p}{,} \PY{n}{SI\PYZus{}MiddleThird\PYZus{}meanstrat}\PY{p}{,} \PY{n}{yerr}\PY{o}{=}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{521}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{521}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                  \PY{n}{xerr}\PY{o}{=}\PY{p}{[}\PY{p}{[}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat}\PY{o}{\PYZhy{}}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat\PYZus{}min}\PY{p}{]}\PY{p}{,}
                        \PY{p}{[}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat\PYZus{}max}\PY{o}{\PYZhy{}}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}plat}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                  \PY{n}{fmt}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{yo}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{middle third (N=20)}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{errorbar}\PY{p}{(}\PY{n}{SI\PYZus{}UpperThird\PYZus{}plat}\PY{p}{,} \PY{n}{SI\PYZus{}UpperThird\PYZus{}meanstrat}\PY{p}{,} \PY{n}{yerr}\PY{o}{=}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{521}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{521}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                  \PY{n}{xerr}\PY{o}{=}\PY{p}{[}\PY{p}{[}\PY{n}{SI\PYZus{}UpperThird\PYZus{}plat}\PY{o}{\PYZhy{}}\PY{n}{SI\PYZus{}UpperThird\PYZus{}plat\PYZus{}min}\PY{p}{]}\PY{p}{,}
                        \PY{p}{[}\PY{n}{SI\PYZus{}UpperThird\PYZus{}plat\PYZus{}max}\PY{o}{\PYZhy{}}\PY{n}{SI\PYZus{}UpperThird\PYZus{}plat}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                  \PY{n}{fmt}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bo}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{upper third (N=34)}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{paleolatitude (degrees)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{stratigraphic thickness (meters)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{fig} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{pyplot}\PY{o}{.}\PY{n}{gcf}\PY{p}{(}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{set\PYZus{}size\PYZus{}inches}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{pylab}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{]}\PY{p}{)}
         \PY{n}{pylab}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{3200}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \section{Comparing larger and smaller stratigraphic subsets of the Simpson Island
data}



    \subsection{Comparing data from the lowermost 500 meters to data from the uppermost
500 meters}


    The analysis above demonstrates that the directions from the lower third
of the stratigraphy (0 to 1041 meters; 30 flows) and the upper third of
the stratigraphy (2083 to 3124 meters; 34 flows) are statistically
distinct and thus indicate statistically significant motion to lower
latitudes. While it is preferable to have a high total number of flows
for such comparisons in order to average out secular variation, let's
conduct this same analysis, but for a more restricted range from the
bottom 500 meters (17 flows) and top 500 meters (17 flows) of the
stratigraphy.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{SI\PYZus{}Lower500m\PYZus{}Directions}\PY{o}{=}\PY{n}{SI\PYZus{}Directions}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{17}\PY{p}{]}
         \PY{n}{SI\PYZus{}Lower500m\PYZus{}Poles}\PY{o}{=}\PY{n}{SI\PYZus{}Poles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{17}\PY{p}{]}
             
         \PY{n}{SI\PYZus{}Upper500m\PYZus{}Directions}\PY{o}{=}\PY{n}{SI\PYZus{}Directions}\PY{p}{[}\PY{l+m+mi}{67}\PY{p}{:}\PY{l+m+mi}{84}\PY{p}{]}
         \PY{n}{SI\PYZus{}Upper500m\PYZus{}Poles}\PY{o}{=}\PY{n}{SI\PYZus{}Poles}\PY{p}{[}\PY{l+m+mi}{67}\PY{p}{:}\PY{l+m+mi}{84}\PY{p}{]}
             
         \PY{n}{Lower500m\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}Lower500m\PYZus{}Directions}\PY{p}{)}
         \PY{n}{Upper500m\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}Upper500m\PYZus{}Directions}\PY{p}{)}
         
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for SI\PYZus{}Lower500m\PYZus{}Directions are: }\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Dec = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Lower500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Inc = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Lower500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Lower500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Lower500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for SI\PYZus{}Upper500m\PYZus{}Directions are: }\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Dec = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Upper500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Inc = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Upper500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Upper500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{Upper500m\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The Fisher mean parameters for SI\_Lower500m\_Directions are: 
Dec = 89.5592116942 Inc = -69.0370984662
alpha95 = 2.72130375778 k= 172.790689067

The Fisher mean parameters for SI\_Upper500m\_Directions are: 
Dec = 106.91559555 Inc = -56.3717140613
alpha95 = 4.61609695128 k= 60.6867572134
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{SI\PYZus{}Lower500m\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}Upper500m\PYZus{}Directions}\PY{p}{)}
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{SI\PYZus{}Lower500m\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}Upper500m\PYZus{}Directions}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           50.4
Critical value of V:  6.3
"Fail": Since V is greater than Vcrit, the two means can
be distinguished at the 95\% confidence level.

M\&M1990 classification:

Angle between data set means: 14.8
Critical angle for M\&M1990:   5.2


===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_39_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_39_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_39_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The results of this comparison between the lower 500 meters and upper
500 meters show that they are distinct populations at the 95\%
confidence level. The difference between the populations is more
dramatic in both the Watson V and bootstrap test from the tests on the
lower third and upper third subsets that were conducted above. This
increase in difference with tighter stratigraphic groups from lower and
higher in the sequence is the expected result if the sequence is a
record of progressive paleogeographic change.


    \subsection{Comparison between data from the lower 1/2 and upper 1/2 of Simpson
Island stratigraphy}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{SI\PYZus{}Directions}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{SI\PYZus{}Poles}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{84}\PY{p}{)}\PY{p}{:}
             \PY{n}{Dec}\PY{p}{,}\PY{n}{Inc}\PY{o}{=}\PY{n}{Dec\PYZus{}TC}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{Inc\PYZus{}TC}\PY{p}{[}\PY{n}{n}\PY{p}{]} 
             \PY{n}{SI\PYZus{}Directions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{Dec}\PY{p}{,}\PY{n}{Inc}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
             \PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{o}{=}\PY{n}{VGP\PYZus{}long}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{VGP\PYZus{}lat}\PY{p}{[}\PY{n}{n}\PY{p}{]}
             \PY{n}{SI\PYZus{}Poles}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
             
         \PY{n}{SI\PYZus{}LowerHalf\PYZus{}Directions}\PY{o}{=}\PY{n}{SI\PYZus{}Directions}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}
         \PY{n}{SI\PYZus{}LowerHalf\PYZus{}Poles}\PY{o}{=}\PY{n}{SI\PYZus{}Poles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}
         \PY{n}{SI\PYZus{}UpperHalf\PYZus{}Directions}\PY{o}{=}\PY{n}{SI\PYZus{}Directions}\PY{p}{[}\PY{l+m+mi}{41}\PY{p}{:}\PY{l+m+mi}{84}\PY{p}{]}
         \PY{n}{SI\PYZus{}UpperHalf\PYZus{}Poles}\PY{o}{=}\PY{n}{SI\PYZus{}Poles}\PY{p}{[}\PY{l+m+mi}{41}\PY{p}{:}\PY{l+m+mi}{84}\PY{p}{]}
          
         \PY{n}{LowerHalf\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}LowerHalf\PYZus{}Directions}\PY{p}{)}
         \PY{n}{UpperHalf\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}UpperHalf\PYZus{}Directions}\PY{p}{)}
         
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The fisher mean parameters for SI\PYZus{}LowerHalf\PYZus{}Directions are: }\PY{l+s}{\PYZsq{}} 
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Dec = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Inc = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The fisher mean parameters for SI\PYZus{}UpperHalf\PYZus{}Directions are: }\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Dec = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Inc = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperHalf\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The fisher mean parameters for SI\_LowerHalf\_Directions are: 
Dec = 98.3683994117 Inc = -66.1920879279
alpha95 = 3.31197629718 k= 46.4016899603

The fisher mean parameters for SI\_UpperHalf\_Directions are: 
Dec = 109.926576191 Inc = -63.0929234842
alpha95 = 3.05246279053 k= 51.8737553101
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{SI\PYZus{}LowerHalf\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}UpperHalf\PYZus{}Directions}\PY{p}{)}
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{SI\PYZus{}LowerHalf\PYZus{}Directions}\PY{p}{,}\PY{n}{SI\PYZus{}UpperHalf\PYZus{}Directions}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           10.4
Critical value of V:  6.1
"Fail": Since V is greater than Vcrit, the two means can
be distinguished at the 95\% confidence level.

M\&M1990 classification:

Angle between data set means: 5.8
Critical angle for M\&M1990:   4.5


===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_43_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_43_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_43_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \section{Calculating and plotting mean pole positions}


    The code below calculates the Fisher mean parameters for poles of the
stratigraphically grouped virtual geomagnetic poles (VGPs) and then
plots them on a ``view from space'' globe. Note that while where the
textual output says ``dec'' it actually referes to pole longitude and
where it says ``inc'' it actually refers to pole latitude since the
pmag.fisher\_mean function is being conducted on VGPs.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{LowerThird\PYZus{}MeanPole}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Poles}\PY{p}{)}
         \PY{n}{MiddleThird\PYZus{}MeanPole}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}MiddleThird\PYZus{}Poles}\PY{p}{)}
         \PY{n}{UpperThird\PYZus{}MeanPole}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Poles}\PY{p}{)}
         
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for the LowerThird mean pole are: }\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Plong = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Plat = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{A95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{LowerThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for the MiddleThird mean pole are: }\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Plong = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{MiddleThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Plat = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{MiddleThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{A95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{MiddleThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{MiddleThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The Fisher mean parameters for the UpperThird mean pole are: }\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Plong = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Plat = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{A95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{UpperThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{c}{\PYZsh{}setup the figure and map}
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{m} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ortho}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{lat\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{35}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{l}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{c}{\PYZsh{} draw coastlines, country boundaries, fill continents.}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{c}{\PYZsh{}map.drawcountries(linewidth=0.25)}
         \PY{n}{m}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{coral}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{white}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawmapboundary}\PY{p}{(}\PY{n}{fill\PYZus{}color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{white}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{360}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{90}\PY{p}{,}\PY{l+m+mi}{90}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{)}
         
         \PY{c}{\PYZsh{}plot the mean poles}
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{poleplot}\PY{p}{(}\PY{n}{m}\PY{p}{,}\PY{n}{LowerThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{LowerThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                        \PY{n}{LowerThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Osler Group Lower Reversed Pole}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{poleplot}\PY{p}{(}\PY{n}{m}\PY{p}{,}\PY{n}{MiddleThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{MiddleThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                        \PY{n}{MiddleThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{y}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Osler Group Middle Reversed Pole}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{poleplot}\PY{p}{(}\PY{n}{m}\PY{p}{,}\PY{n}{UpperThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{UpperThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                        \PY{n}{UpperThird\PYZus{}MeanPole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{b}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Osler Group Upper Reversed Pole}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         
         \PY{c}{\PYZsh{}show the plot}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.05}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The Fisher mean parameters for the LowerThird mean pole are: 
Plong = 218.637832609 Plat = 40.937318541
A95 = 4.76006232039 k= 31.4671112908

The Fisher mean parameters for the MiddleThird mean pole are: 
Plong = 211.261736125 Plat = 42.7378078852
A95 = 8.1783359746 k= 16.9030328287

The Fisher mean parameters for the UpperThird mean pole are: 
Plong = 205.410227513 Plat = 41.5645761829
A95 = 4.80394668574 k= 27.2260167637
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_46_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Note that in the print out for the mean pole calculations above `dec' is
really the longitude of the pole (Plong) and `inc' is actually the
latitude of the pole (Plat).

\begin{longtable}[c]{@{}lllll@{}}
\hline\noalign{\medskip}
Pole ID & Plong & Plat & A95 & N
\\\noalign{\medskip}
\hline\noalign{\medskip}
SI\_Lower & 218.6 & 40.9 & 4.8 & 30
\\\noalign{\medskip}
SI\_Middle & 211.3 & 42.7 & 8.2 & 20
\\\noalign{\medskip}
SI\_Upper & 205.4 & 41.6 & 4.8 & 34
\\\noalign{\medskip}
\hline
\end{longtable}


    \section{Comparison between Halls (1974) data and Simpson Island VGPs}


    Halls (1974) developed paleomagnetic data from the Osler Volcanic Group
in the Nipogon Straits region (bibtex citation below; also see
\url{http://earthref.org/MAGIC/9518}). For the purposes of the
previously contributed MagIC database entries, site locations were
determined using georeferenced versions of the maps provided in Halls
(1974). These data allow for the site means of Halls (1974) to be used
to calculate VGPs for purposes of directional statistical tests and for
combining into a mean paleopole. The Halls (1974) data are predominantly
from flows with reversed magnetization below an angular unconformity on
Puff Island that seperates the reversedly magnetized flows from younger
flows of normal polarity (only a few of which are preserved before the
sequence is submerged beneath Lake Superior). The analysis below
compares paleomagnetic data from this study with the reversed flows from
the Halls (1974) data. The result from this analysis is that the Halls
(1974) data is statistically distinct from the lower third of the
Simpson Island stratigraphy, but is statistically indistinguishable from
the upper third of the Simpson Island stratigraphy. This result fits
with stratigraphic considerations that place the sites studied by Halls
towards the top of the stratigraphy studied herein at Simpson Island.

                Bibtex citation info for Halls (1974)
@article{Halls1974a,
	Author = {Halls, H.C.},
	Journal = {Canadian Journal of Earth Science},
	Pages = {1200-1207},
	Title = {A paleomagnetic reversal in the {O}sler {V}olcanic {G}roup, northern {L}ake {S}uperior},
	Volume = {11},
	Year = {1974}}
                
    The code below imports the directional data from Halls (1974) and than
uses this data to calculate virtual geomagnetic poles for each site
location.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data}\PY{o}{=}\PY{n}{pandas}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{../2014\PYZus{}Osler\PYZus{}Data/Halls1974\PYZus{}data.csv}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{sep}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{,}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data} 
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:}          Study  Site\_ID  AFstep\_Oe  dec\_tc  inc\_tc  kappa  n  site\_lat  \textbackslash{}
         0   Halls1974a        1        200   289.8    43.6    517  5     48.63   
         1   Halls1974a        2        150   285.7    42.0    243  5     48.64   
         2   Halls1974a        3        100   307.4    37.9   2485  5     48.64   
         3   Halls1974a        4        150   302.8    29.9    331  5     48.66   
         4   Halls1974a        5        300   294.7    42.5    130  5     48.66   
         5   Halls1974a        6        100   106.1   -44.2     70  5     48.66   
         6   Halls1974a        7        250   109.8   -62.4    351  6     48.68   
         7   Halls1974a        8        400   140.7   -64.8    679  5     48.68   
         8   Halls1974a        9        150   110.0   -56.6    321  3     48.68   
         9   Halls1974a       10        150   128.2   -42.0     59  5     48.66   
         10  Halls1974a       11        400    88.3   -59.1    456  3     48.66   
         11  Halls1974a       12        250   118.6   -48.9    240  5     48.66   
         12  Halls1974a       13        250   128.1   -38.0    886  3     48.65   
         13  Halls1974a       14        200   108.2   -55.8    121  6     48.65   
         14  Halls1974a       15        300   118.5   -46.0    402  6     48.65   
         15  Halls1974a       16        150   106.0   -54.2    125  6     48.64   
         16  Halls1974a       17        300    93.7   -54.1    362  4     48.63   
         17  Halls1974a       18        200   116.0   -53.0    224  4     48.61   
         18  Halls1974a       19        200   131.7   -64.9    871  4     48.61   
         19  Halls1974a       20        250   119.9   -55.8    108  4     48.59   
         20  Halls1974a       21        300    94.3   -65.5     84  5     48.64   
         21  Halls1974a       22        200    91.8   -58.2     94  5     48.64   
         22  Halls1974a       23        300   114.3   -64.0     69  4     48.62   
         23  Halls1974a       24        400   116.8   -40.4     77  3     48.68   
         24  Halls1974a       25        150   126.3   -58.7    166  3     48.69   
         25  Halls1974a       26        300   112.0   -75.1   3634  3     48.71   
         26  Halls1974a       27        400   118.6   -70.3    729  3     48.67   
         27  Halls1974a       28        150   132.6   -54.1   1039  3     48.68   
         28  Halls1974a       29        250   129.1   -54.5   1149  3     48.68   
         29  Halls1974a       30        300    80.5   -80.4    267  5     48.59   
         
             site\_long  
         0      -88.11  
         1      -88.09  
         2      -88.07  
         3      -88.04  
         4      -88.04  
         5      -88.05  
         6      -88.02  
         7      -88.03  
         8      -88.06  
         9      -88.07  
         10     -88.07  
         11     -88.08  
         12     -88.09  
         13     -88.08  
         14     -88.10  
         15     -88.10  
         16     -88.11  
         17     -88.16  
         18     -88.17  
         19     -88.19  
         20     -88.12  
         21     -88.12  
         22     -88.16  
         23     -88.06  
         24     -88.05  
         25     -88.07  
         26     -88.10  
         27     -88.10  
         28     -88.10  
         29     -88.22  
         
         [30 rows x 9 columns]
\end{Verbatim}
        
    Calculate VGPs using the Halls (1974) data:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{VGP\PYZus{}calc}\PY{p}{(}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data}\PY{p}{)}
         \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:}         Study  Site\_ID  AFstep\_Oe  dec\_tc  inc\_tc  kappa  n  site\_lat  \textbackslash{}
         0  Halls1974a        1        200   289.8    43.6    517  5     48.63   
         1  Halls1974a        2        150   285.7    42.0    243  5     48.64   
         2  Halls1974a        3        100   307.4    37.9   2485  5     48.64   
         3  Halls1974a        4        150   302.8    29.9    331  5     48.66   
         4  Halls1974a        5        300   294.7    42.5    130  5     48.66   
         
            site\_long  paleolatitude   pole\_lat   pole\_long  pole\_lat\_rev  \textbackslash{}
         0     -88.11      25.461154  31.651781  185.568167    -31.651781   
         1     -88.09      24.237370  28.110360  187.509415    -28.110360   
         2     -88.07      21.267947  40.260801  167.888919    -40.260801   
         3     -88.04      16.040618  33.459149  167.496979    -33.459149   
         4     -88.04      24.615622  34.309281  181.259648    -34.309281   
         
            pole\_long\_rev  
         0       5.568167  
         1       7.509415  
         2     347.888919  
         3     347.496979  
         4       1.259648  
         
         [5 rows x 14 columns]
\end{Verbatim}
        
    Split the dataframe into one for the normally magnetized sites and one
for the reversed polarity sites

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data\PYZus{}N} \PY{o}{=} \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}
         \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data\PYZus{}R} \PY{o}{=} \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{:}\PY{p}{]}
         \PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data\PYZus{}R}\PY{o}{=}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data\PYZus{}R}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    Develop a list of unit vectors of the reversed Halls (1974) VGPs in
order to conduct common mean tests with the Simpson Island data using
pmag.py functions.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}VGPs}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}Plong}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}Plat}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data\PYZus{}R}\PY{p}{)}\PY{p}{)}\PY{p}{:} 
             \PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{o}{=}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data\PYZus{}R}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}long\PYZus{}rev}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}Data\PYZus{}R}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}lat\PYZus{}rev}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{n}\PY{p}{]}
             \PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}Plong}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Plong}\PY{p}{)}
             \PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}Plat}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Plat}\PY{p}{)}
             \PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}VGPs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \subsection{Common mean tests between Halls (1974) data and the data from the lower
third of the Simpson Island stratigraphy}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}VGPs}\PY{p}{,}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Poles}\PY{p}{)}
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}VGPs}\PY{p}{,}\PY{n}{SI\PYZus{}LowerThird\PYZus{}Poles}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           31.0
Critical value of V:  6.3
"Fail": Since V is greater than Vcrit, the two means can
be distinguished at the 95\% confidence level.

M\&M1990 classification:

Angle between data set means: 16.7
Critical angle for M\&M1990:   7.5


===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_60_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_60_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_60_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    A comparison between VGPs calculated from Halls, 1974 data and data
from the lower third of the Simpson Island stratigraphy fails Watson's V
and bootstrap tests for a common mean indicating that the populations of
directions do not share a common mean at the 95\% confidence level.


    \subsection{Common mean tests between Halls (1974) data and the data from the upper
third of the Simpson Island stratigraphy}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{IPmag}\PY{o}{.}\PY{n}{iWatsonV}\PY{p}{(}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}VGPs}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Poles}\PY{p}{)}
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{iBootstrap}\PY{p}{(}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}VGPs}\PY{p}{,}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Poles}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Results of Watson V test: 

Watson's V:           5.4
Critical value of V:  6.5
"Pass": Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M\&M1990 classification:

Angle between data set means: 7.0
Critical angle for M\&M1990:   7.7
The McFadden and McElhinny (1990) classification for
this test is: 'B'

===============

Here are the results of the bootstrap test for a common mean
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_63_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_63_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_63_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    A comparison between VGPs calculated from Halls, 1974 data (see
\url{http://earthref.org/MAGIC/9518}) and data from the upper third of
the Simpson Island stratigraphy passes Watson's V and bootstrap tests
for a common mean.


    \subsection{Combining the data from the upper third of the Simpson Island
stratigraphy and the Halls (1974) reversed polarity data into a single
pole for the upper portion of the reversed Osler Group stratigraphy}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{upperR\PYZus{}Osler\PYZus{}VGPs}\PY{o}{=}\PY{n}{Halls1974\PYZus{}Osler\PYZus{}R\PYZus{}VGPs}\PY{o}{+}\PY{n}{SI\PYZus{}UpperThird\PYZus{}Poles}
         
         \PY{n}{upperR\PYZus{}Osler\PYZus{}meanpole}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{upperR\PYZus{}Osler\PYZus{}VGPs}\PY{p}{)}
         
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The fisher mean parameters for the pole calculated from upper reversed}\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Osler Group VGPs (SI\PYZus{}UpperThird\PYZus{}Poles+Halls, 1974 reversed data) are: }\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Plong = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upperR\PYZus{}Osler\PYZus{}meanpole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ Plat = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upperR\PYZus{}Osler\PYZus{}meanpole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{A95 = }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upperR\PYZus{}Osler\PYZus{}meanpole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ k= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upperR\PYZus{}Osler\PYZus{}meanpole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ N= }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{upperR\PYZus{}Osler\PYZus{}meanpole}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{n}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The fisher mean parameters for the pole calculated from upper reversed
Osler Group VGPs (SI\_UpperThird\_Poles+Halls, 1974 reversed data) are: 
Plong = 201.646829641 Plat = 42.5371761039
A95 = 3.72282691107 k= 25.6773898601 N= 59
    \end{Verbatim}

    \begin{longtable}[c]{@{}llllll@{}}
\hline\noalign{\medskip}
Pole ID & Plong & Plat & A95 & N & approximate age
\\\noalign{\medskip}
\hline\noalign{\medskip}
upper Osler Group reversed pole & 201.6 & 42.5 & 3.7 & 59 & 1105Â±2 Ma
\\\noalign{\medskip}
(this work and Halls, 1974) & & & & & (Davis and Green, 1997)
\\\noalign{\medskip}
\hline
\end{longtable}


    \section{Paleogeographic work outside of this IPython notebook using the software
package GPlates.}


    For details on working with paleomagnetic data in GPlates check out
\href{https://docs.google.com/document/pub?id=1gdgHIaC5WpjLaRZu1JwqotV8zOrgnfu_fZ3aNwQZNmU}{this
tutorial}.

The steps necessary to develop the reconstruction using these Osler
Volcanic Group poles are detailed below.

    \begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\itemsep1pt\parskip0pt\parsep0pt
\item
  Develop .rot file that rotates Laurentia such that the Osler poles are
  at geographic north. In the text for the .rot file below the
  Osler\_lowerthird pole is assigned to 1110 Ma, the Osler\_middlethird
  pole is assigned to 1107.5 and the Osler\_upperthird pole is assigned
  to 1105 Ma.
\end{enumerate}

The .rot file has the format:

\textbar{}moving plate ID number\textbar{}age in millions of
years\textbar{}latitude of Euler pole\textbar{}longitude of Euler
pole\textbar{}angle\textbar{}fixed plate\textbar{}comment\textbar{}
\textbar{}----------------------\textbar{}------------------------\textbar{}----------------------\textbar{}-----------------------\textbar{}-----\textbar{}-----------\textbar{}-------\textbar{}

In this .rot file, the fixed reference frame is 000 and 001 (which could
be split into a relative and absolute reference frame that seperates out
TPW), while the plate ID for Laurentia is 199.

                001  0.0   0.0    0.0    0.0  000 ! \\
001 3900.0   0.0    0.0    0.0  000 ! \\
199  0.0   0.0    0.0    0.0  001 ! \\
199 1105.0   0.0  115.4   48.4  001 !Put Osler-upperthird at N for Laurentia \\
199 1107.5   0.0  121.3   47.3  001 !Put Osler-middlethird at N for Laurentia \\
199 1110.0   0.0  128.7   49.0  001 !Put Osler-lowerthird at N for Laurentia \\
                
    \begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\setcounter{enumi}{1}
\itemsep1pt\parskip0pt\parsep0pt
\item
  Open the following feature collections in GPlates: 199-Laurentia
  nogrid.dat, OslerPoles.gpml and Osler.rot where 199-Laurentia
  nogrid.dat is the outline of Laurentia in the late Proterozoic and
  OslerPoles.gpml contains the three calculated Osler paleomagnetic
  poles. An animation from 1110 to 1105 Ma yields the following
  reconstruction shown here with a time slice for Osler\_lowerthird
  (red), Osler\_middlethird (yellow) and Osler\_upperthird (blue).
\end{enumerate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{k+kn}{from} \PY{n+nn}{IPython.display} \PY{k+kn}{import} \PY{n}{SVG}
         \PY{n}{SVG}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Paleogeo.svg}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\texttt{\color{outcolor}Out[{\color{outcolor}23}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_73_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    


    \section{Plate rate estimate}


    This portion of the analysis calculates plate motion rates and estimates
the uncertainity associated with these rates using Monte Carlo
simulations that utilize both the uncertainity on the position and age
of two paleomagnetic poles. For this analysis we are using these two
poles: 1. Pole 1: Osler Volcanic Group (early magmatic stage). The pole
is the combined mean of the upper portion of the reversed stratigraphy
that uses data from this study and Halls (1974). The date of 1105 $\pm$
2 Ma is used to constrain the age of the pole since it comes from an
extrusive unit in close stratigraphic proximity to the units from which
the paleomagnetic data were obtained. 2. Pole 2: North Shore Volcanic
Group (main magmatic stage). The North Shore Volcanic Group spans more
than 10 million years and subsets of the data need to be considered for
a pole to provide precise constraints. The pole used here is calculated
from data developed by Tauxe and Kodama (2009) and is the mean of 47
sites from between the 40th Ave icelandite and the Palisade rhyolite
within the southwest limb of the North Shore Volcanic Group. The 40th
Ave icelandite has a U-Pb date of 1098.4 $\pm$ 1.9 Ma and the Palisade
rhyolite has a U-Pb date of 1096.6 $\pm$ 1.7 Ma.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c}{\PYZsh{}import a couple special functions from scipy}
         \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k+kn}{import} \PY{n}{special}
         \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k+kn}{import} \PY{n}{stats}
\end{Verbatim}


    \subsection{Calculating the NSVG pole}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{Tauxe\PYZus{}NSVG\PYZus{}Data}\PY{o}{=}\PY{n}{pandas}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{../2014\PYZus{}Osler\PYZus{}Data/Tauxe2009a\PYZus{}data.csv}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{sep}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{,}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{c}{\PYZsh{}show first 5 rows}
         \PY{n}{Tauxe\PYZus{}NSVG\PYZus{}Data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:}   site\_ID  dec\_tc  inc\_tc  a95  n  site\_lat  site\_long  pole\_lat  pole\_long  \textbackslash{}
         0   ns002   283.5    38.7  6.6  4   47.7341   -90.4292      24.9      185.2   
         1   ns003   286.9    47.9  3.8  5   47.7371   -90.4114      32.0      188.9   
         2   ns004   290.0    47.8  5.6  5   47.7328   -90.4363      34.0      186.7   
         3   ns005   299.8    37.6  5.3  4   47.7254   -90.4430      35.3      172.4   
         4   ns006   294.8    38.8  3.0  5   47.7161   -90.4904      32.5      177.0   
         
           rem\_type sequence  unit  
         0      hem     nneu  ngha  
         1    mixed     nneu  ngha  
         2      mag     nneu  ngha  
         3      mag     nneu   ngt  
         4      mag      nsl   NaN  
         
         [5 rows x 12 columns]
\end{Verbatim}
        
    The North Shore Volcanic Group (NSVG) is comprised of two main limbs
with distinct stratigraphy and radiometric age control. The southwest
limb of the NSVG was particularly well-sampled by Tauxe and Kodama
(2009) and those sites can be bracketed with age control from the 40th
Ave icelandite (Davis and Green, 1997; 1098.4 Â± 1.9 Ma) and the Palisade
rhyolite (Davis and Green, 1997; 1096.6 Â± 1.7 Ma).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{NSVG\PYZus{}nswu}\PY{o}{=}\PY{n}{Tauxe\PYZus{}NSVG\PYZus{}Data}\PY{o}{.}\PY{n}{ix}\PY{p}{[}\PY{n}{Tauxe\PYZus{}NSVG\PYZus{}Data}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{sequence}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{nswu}\PY{l+s}{\PYZsq{}}\PY{p}{]}
         \PY{n}{NSVG\PYZus{}nswu}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         
         \PY{n}{NSVG\PYZus{}nswu\PYZus{}VGPs}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{NSVG\PYZus{}nswu\PYZus{}Plong}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{NSVG\PYZus{}nswu\PYZus{}Plat}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu}\PY{p}{)}\PY{p}{)}\PY{p}{:} 
             \PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{o}{=}\PY{n}{NSVG\PYZus{}nswu}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}long}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{NSVG\PYZus{}nswu}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{n}\PY{p}{]}
             \PY{n}{NSVG\PYZus{}nswu\PYZus{}Plong}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Plong}\PY{p}{)}
             \PY{n}{NSVG\PYZus{}nswu\PYZus{}Plat}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Plat}\PY{p}{)}
             \PY{n}{NSVG\PYZus{}nswu\PYZus{}VGPs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{Plong}\PY{p}{,}\PY{n}{Plat}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
         \PY{n}{NSVG\PYZus{}nswu\PYZus{}mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}VGPs}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Here are the details for the calculated pole from the SW limb of the NSVG}\PY{l+s}{\PYZsq{}}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Pole longitude is: }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Pole latitude is: }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Pole kappa is: }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Pole A95 is: }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{alpha95}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{Pole N is: }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{n}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Here are the details for the calculated pole from the SW limb of the NSVG
Pole longitude is: 182.1
Pole latitude is: 35.8
Pole kappa is: 45.7
Pole A95 is: 3.1
Pole N is: 47
    \end{Verbatim}


    \subsection{Input pole data and simulation sample size}


    The code box below is where the input parameters for the Monte Carlo
rate simulation are entered. These parameters are: - \texttt{samplesize}
determines the number of random pole pairs that will be made through
Monte Carlo simulations of each pole and its age to determine rate. -
Paleomagnetic pole longitude (\texttt{plong}) and latitude
(\texttt{plat}) for each pole - The A$_{95}$ confidence ellipse
(\texttt{A95}), the Fisher precision parameter (\texttt{kappa}), and
number of virtual geomagnetic poles used to calculate the pole mean
(\texttt{N}). - The age assigned to the pole and the 1$\sigma$
uncertainity on that age (\texttt{age\_error}).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{samplesize}\PY{o}{=}\PY{l+m+mi}{100000}
         \PY{c}{\PYZsh{}set at 100,000 this code will take a long time to run}
         
         \PY{c}{\PYZsh{}parameters for pole 1 (OVG pole calculated above)}
         \PY{n}{pole1\PYZus{}plong}\PY{o}{=}\PY{l+m+mf}{201.6}
         \PY{n}{pole1\PYZus{}plat}\PY{o}{=}\PY{l+m+mf}{42.5}
         \PY{n}{pole1\PYZus{}A95}\PY{o}{=}\PY{l+m+mf}{3.7}
         \PY{n}{pole1\PYZus{}kappa}\PY{o}{=}\PY{l+m+mf}{25.7}
         \PY{n}{pole1\PYZus{}N}\PY{o}{=}\PY{l+m+mi}{59}
         \PY{n}{pole1\PYZus{}age}\PY{o}{=}\PY{l+m+mi}{1105}
         \PY{c}{\PYZsh{}1 sigma age uncertainity}
         \PY{n}{pole1\PYZus{}age\PYZus{}error}\PY{o}{=}\PY{l+m+mi}{1}
         
         \PY{c}{\PYZsh{}parameters for pole 2 (NSVG pole calculated above)}
         \PY{n}{pole2\PYZus{}plong}\PY{o}{=}\PY{l+m+mf}{182.1}
         \PY{n}{pole2\PYZus{}plat}\PY{o}{=}\PY{l+m+mf}{35.8}
         \PY{n}{pole2\PYZus{}A95}\PY{o}{=}\PY{l+m+mf}{3.1}
         \PY{n}{pole2\PYZus{}kappa}\PY{o}{=}\PY{l+m+mf}{45.7}
         \PY{n}{pole2\PYZus{}N}\PY{o}{=}\PY{l+m+mi}{47}
         \PY{c}{\PYZsh{}taking the average of the 40th Ave and Palisade}
         \PY{n}{pole2\PYZus{}age}\PY{o}{=}\PY{l+m+mf}{1097.5}
         \PY{c}{\PYZsh{}2sigma uncertainity min age on Palisade is 1094.9}
         \PY{c}{\PYZsh{}2sigma uncertainity min age on 40th Ave is 1100.3}
         \PY{c}{\PYZsh{}a 2sigma of 2.7 on the pole2\PYZus{}age approx spans this range}
         \PY{c}{\PYZsh{}giving a 1 sigma age uncertainty of}
         \PY{n}{pole2\PYZus{}age\PYZus{}error}\PY{o}{=}\PY{l+m+mf}{1.35}
         
         \PY{c}{\PYZsh{}the longitude, latitude of Duluth, MN as a reference location}
         \PY{n}{Duluth}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{267.9}\PY{p}{,} \PY{l+m+mf}{46.8}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{pole1}\PY{o}{=}\PY{p}{(}\PY{n}{pole1\PYZus{}plong}\PY{p}{,} \PY{n}{pole1\PYZus{}plat}\PY{p}{)}
         \PY{n}{pole1\PYZus{}paleolat}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pmag}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{pole1}\PY{p}{,}\PY{n}{Duluth}\PY{p}{)}
         \PY{n}{pole2}\PY{o}{=}\PY{p}{(}\PY{n}{pole2\PYZus{}plong}\PY{p}{,} \PY{n}{pole2\PYZus{}plat}\PY{p}{)}
         \PY{n}{pole2\PYZus{}paleolat}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pmag}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{pole2}\PY{p}{,}\PY{n}{Duluth}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The paleolatitude for Duluth resulting from pole 1 is:}\PY{l+s}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{pole1\PYZus{}paleolat}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The paleolatitude for Duluth resulting from pole 2 is:}\PY{l+s}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{pole2\PYZus{}paleolat}\PY{p}{)}
         \PY{n}{rate}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{pole1\PYZus{}paleolat}\PY{o}{\PYZhy{}}\PY{n}{pole2\PYZus{}paleolat}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{111}\PY{o}{*}\PY{l+m+mi}{100000}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{p}{(}\PY{n}{pole1\PYZus{}age}\PY{o}{\PYZhy{}}\PY{n}{pole2\PYZus{}age}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{1000000}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The rate of paleolatitudinal change implied by the poles pairs in cm/yr is:}\PY{l+s}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{rate}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The paleolatitude for Duluth resulting from pole 1 is:[ 44.05491798]
The paleolatitude for Duluth resulting from pole 2 is:[ 27.84482051]
The rate of paleolatitudinal change implied by the poles pairs in cm/yr is:[ 23.99094426]
    \end{Verbatim}


    \subsection{Sampling the age distributions}


    Weighted means calculated from geochronological data are typically
assumed to have uncertainity that follows a Gaussian distribution. Using
this assumption, we can use the numpy function \texttt{random} to
randomly sample a normal distribution. This approach is straightforward
for a paleomagnetic pole where we are assigning a single age (e.g.
\texttt{pole1} in this case). It is less straightforward when using two
dates that stratigraphically bracket flows from which the paleomagnetic
data was obtained without an a priori assumption of the distribution of
time between those two dated units. In this analysis, we approximate the
age error distribution for \texttt{pole2} by taking the mean of the
dated units that bracket the data as the mean age and then specifying an
age uncertainity wherein 2$\sigma$ reaches out to approximately reach
the maximum and minimum dates implied by the 2$\sigma$ uncertainities on
the older and younger dates respectively. This approach specifies a
distribution that is centered on the mean of the two dates while also
including the possibility that the actual age of the pole could come
from a distribution that spans out to include the older and younger
possibilities of each dated unit.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{pole1\PYZus{}MCages}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{pole1\PYZus{}age}\PY{p}{,}\PY{n}{pole1\PYZus{}age\PYZus{}error}\PY{p}{,}\PY{n}{samplesize}\PY{p}{)}
         \PY{n}{pole2\PYZus{}MCages}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{pole2\PYZus{}age}\PY{p}{,}\PY{n}{pole2\PYZus{}age\PYZus{}error}\PY{p}{,}\PY{n}{samplesize}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{pole1\PYZus{}MCages}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{n}{histtype}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{stepfilled}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{darkred}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Pole 1 ages}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{pole2\PYZus{}MCages}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{n}{histtype}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{stepfilled}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{darkblue}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Pole 2 ages}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Age (Ma)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{n}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_87_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsection{Sampling pole distributions}


    To determine the uncertainity on the pole position and associated
paleolatitude, we can take the approach of random sampling from the
Fisher distribution with the precision of the VGPs used to develop the
pole. To do this in a Monte Carlo fashion, we can grab random samples
utilizing the fshdev function from pmag.py which takes random samples
from a distribution with a given Fisher precision parameter (kappa)
centered on (Dec=0, Inc=90). We can then define a tilt\_direction to be
the longitude of the pole mean and a tilt\_amount to be the conjugate of
the latitude of the pole mean and then use the dotilt function of
pmag.py to rotate the polar-centered distribution to be centered about
the pole mean. Doing this for the same number of VGPs used to calculate
the actual pole allows us to then calculate a mean pole. This can then
be done repeated (as dictated by the sample size number) to get a
population of mean poles that can result from sampling the distribution.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{pole1\PYZus{}MCpoles}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole1\PYZus{}MCpole\PYZus{}lat}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole1\PYZus{}MCpole\PYZus{}long}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole1\PYZus{}MCpaleolat}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{samplesize}\PY{p}{)}\PY{p}{:}
             \PY{n}{vgp\PYZus{}samples}\PY{o}{=}\PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{vgp} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pole1\PYZus{}N}\PY{p}{)}\PY{p}{:}
                 \PY{c}{\PYZsh{}pmag.dev returns a direction from a fisher distribution with specified kappa}
                 \PY{n}{direction\PYZus{}atN}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fshdev}\PY{p}{(}\PY{n}{pole1\PYZus{}kappa}\PY{p}{)}
                 \PY{c}{\PYZsh{}this direction is centered at latitude of 90Âº and needs to be rotated}
                 \PY{c}{\PYZsh{}to be centered on the mean pole position}
                 \PY{n}{tilt\PYZus{}direction}\PY{o}{=}\PY{n}{pole1\PYZus{}plong}
                 \PY{n}{tilt\PYZus{}amount}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pole1\PYZus{}plat}
                 \PY{n}{direction}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{dotilt}\PY{p}{(}\PY{n}{direction\PYZus{}atN}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{direction\PYZus{}atN}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{tilt\PYZus{}direction}\PY{p}{,}\PY{n}{tilt\PYZus{}amount}\PY{p}{)}
                 \PY{n}{vgp\PYZus{}samples}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{direction}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{direction}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
             \PY{n}{mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{vgp\PYZus{}samples}\PY{p}{)}
             \PY{n}{mean\PYZus{}pole\PYZus{}position}\PY{o}{=}\PY{p}{(}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{pole1\PYZus{}MCpoles}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
             \PY{n}{pole1\PYZus{}MCpole\PYZus{}lat}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{pole1\PYZus{}MCpole\PYZus{}long}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{paleolat}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pmag}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{mean\PYZus{}pole\PYZus{}position}\PY{p}{,}\PY{n}{Duluth}\PY{p}{)}
             \PY{n}{pole1\PYZus{}MCpaleolat}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{paleolat}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{pole2\PYZus{}MCpoles}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole2\PYZus{}MCpole\PYZus{}lat}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole2\PYZus{}MCpole\PYZus{}long}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole2\PYZus{}MCpaleolat}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{samplesize}\PY{p}{)}\PY{p}{:}
             \PY{n}{vgp\PYZus{}samples}\PY{o}{=}\PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{vgp} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pole2\PYZus{}N}\PY{p}{)}\PY{p}{:}
                 \PY{c}{\PYZsh{}pmag.dev returns a direction from a fisher distribution with specified kappa}
                 \PY{n}{direction\PYZus{}atN}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fshdev}\PY{p}{(}\PY{n}{pole2\PYZus{}kappa}\PY{p}{)}
                         \PY{c}{\PYZsh{}this direction is centered at latitude of 90Âº and needs to be rotated}
                 \PY{c}{\PYZsh{}to be centered on the mean pole position}
                 \PY{n}{tilt\PYZus{}direction}\PY{o}{=}\PY{n}{pole2\PYZus{}plong}
                 \PY{n}{tilt\PYZus{}amount}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pole2\PYZus{}plat}
                 \PY{n}{direction}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{dotilt}\PY{p}{(}\PY{n}{direction\PYZus{}atN}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{direction\PYZus{}atN}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{tilt\PYZus{}direction}\PY{p}{,}\PY{n}{tilt\PYZus{}amount}\PY{p}{)}
                 \PY{n}{vgp\PYZus{}samples}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{direction}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{direction}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
             \PY{n}{mean}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{vgp\PYZus{}samples}\PY{p}{)}
             \PY{n}{mean\PYZus{}pole\PYZus{}position}\PY{o}{=}\PY{p}{(}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{pole2\PYZus{}MCpoles}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
             \PY{n}{pole2\PYZus{}MCpole\PYZus{}lat}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{pole2\PYZus{}MCpole\PYZus{}long}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{paleolat}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pmag}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{mean\PYZus{}pole\PYZus{}position}\PY{p}{,}\PY{n}{Duluth}\PY{p}{)}
             \PY{n}{pole2\PYZus{}MCpaleolat}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{paleolat}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{m} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ortho}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{lat\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{35}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{c}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{area\PYZus{}thresh}\PY{o}{=}\PY{l+m+mi}{50000}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bisque}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{white}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawmapboundary}\PY{p}{(}\PY{n}{fill\PYZus{}color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{white}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{360}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{)}
         \PY{n}{m}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{90}\PY{p}{,}\PY{l+m+mi}{90}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{vgpplot}\PY{p}{(}\PY{n}{m}\PY{p}{,}\PY{n}{pole1\PYZus{}MCpole\PYZus{}long}\PY{p}{,}\PY{n}{pole1\PYZus{}MCpole\PYZus{}lat}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{b}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{IPmag}\PY{o}{.}\PY{n}{vgpplot}\PY{p}{(}\PY{n}{m}\PY{p}{,}\PY{n}{pole2\PYZus{}MCpole\PYZus{}long}\PY{p}{,}\PY{n}{pole2\PYZus{}MCpole\PYZus{}lat}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{g}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_91_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsection{Calculate and graphically display the confidence interval on the minimum
rate estimate implied by the Monte Carlo sampled pairs of sampled ages
and paleolatitudes from the two poles}


    The pairs of sampled ages and poles can be used to calcuate rates (with
the total number of rates being set by \texttt{samplesize} in the input
box above). The rate calculated above of 24.0 cm/year can now be given
confidence bounds by taking 2.5 percentile and 97.5 percentile of the
Monte Carlo simulated rates.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{c}{\PYZsh{}calculating the change in paleolatitude between the Monte Carlo pairs}
         \PY{n}{pole1\PYZus{}pole2\PYZus{}Delta\PYZus{}degrees}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole1\PYZus{}pole2\PYZus{}Delta\PYZus{}kilometers}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole1\PYZus{}pole2\PYZus{}Delta\PYZus{}myr}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole1\PYZus{}pole2\PYZus{}degrees\PYZus{}per\PYZus{}myr}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{pole1\PYZus{}pole2\PYZus{}cm\PYZus{}per\PYZus{}yr}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{samplesize}\PY{p}{)}\PY{p}{:}
             \PY{n}{Delta\PYZus{}degrees}\PY{o}{=}\PY{n}{pole1\PYZus{}MCpaleolat}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{pole2\PYZus{}MCpaleolat}\PY{p}{[}\PY{n}{n}\PY{p}{]}
             \PY{n}{Delta\PYZus{}Myr}\PY{o}{=}\PY{n}{pole1\PYZus{}MCages}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{pole2\PYZus{}MCages}\PY{p}{[}\PY{n}{n}\PY{p}{]}
             \PY{n}{pole1\PYZus{}pole2\PYZus{}Delta\PYZus{}degrees}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Delta\PYZus{}degrees}\PY{p}{)}
             \PY{n}{degrees\PYZus{}per\PYZus{}myr}\PY{o}{=}\PY{n}{Delta\PYZus{}degrees}\PY{o}{/}\PY{n}{Delta\PYZus{}Myr}
             \PY{n}{cm\PYZus{}per\PYZus{}yr}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{Delta\PYZus{}degrees}\PY{o}{*}\PY{l+m+mi}{111}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100000}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{Delta\PYZus{}Myr}\PY{o}{*}\PY{l+m+mi}{1000000}\PY{p}{)}
             \PY{n}{pole1\PYZus{}pole2\PYZus{}degrees\PYZus{}per\PYZus{}myr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{degrees\PYZus{}per\PYZus{}myr}\PY{p}{)}
             \PY{n}{pole1\PYZus{}pole2\PYZus{}cm\PYZus{}per\PYZus{}yr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{cm\PYZus{}per\PYZus{}yr}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{twopointfive\PYZus{}percentile}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{pole1\PYZus{}pole2\PYZus{}cm\PYZus{}per\PYZus{}yr}\PY{p}{,}\PY{l+m+mf}{2.5}\PY{p}{)}
         \PY{n}{fifty\PYZus{}percentile}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{pole1\PYZus{}pole2\PYZus{}cm\PYZus{}per\PYZus{}yr}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n}{ninetysevenpointfive\PYZus{}percentile}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{scoreatpercentile}\PY{p}{(}\PY{n}{pole1\PYZus{}pole2\PYZus{}cm\PYZus{}per\PYZus{}yr}\PY{p}{,}\PY{l+m+mf}{97.5}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{2.5th percentile is: }\PY{l+s}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{twopointfive\PYZus{}percentile}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{50th percentile is: }\PY{l+s}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{fifty\PYZus{}percentile}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{97.5th percentile is: }\PY{l+s}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{ninetysevenpointfive\PYZus{}percentile}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
2.5th percentile is: 15.1860289306
50th percentile is: 23.9833375899
97.5th percentile is: 44.0185724854
    \end{Verbatim}

    We can see here that the 50th percentile from these analysis is the same
as the mean rate previously calculated (24.0 cm/yr). The 2.5th and
97.5th percentile give a 95\% confidence range of 15.2 to 44.4 cm/yr.
The code below generates a plot where 5,000 of the 100,000 (that's what
was set as \texttt{samplesize} when code was executed) pole pairs and
rates are shown (in A) and a histogram of all the rates is plotted along
with the above percentiles being marked. This plot is Figure 4 of the
manuscript.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{plotnumber}\PY{o}{=}\PY{l+m+mi}{5000}
         \PY{n}{figure}\PY{p}{(}\PY{n}{num}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{plotnumber}\PY{p}{)}\PY{p}{:}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{pole1\PYZus{}MCpaleolat}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{pole2\PYZus{}MCpaleolat}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{]}\PY{p}{,}
                      \PY{p}{[}\PY{n}{pole1\PYZus{}MCages}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{pole2\PYZus{}MCages}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{k\PYZhy{}}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{pole1\PYZus{}MCpaleolat}\PY{p}{[}\PY{p}{:}\PY{n}{plotnumber}\PY{p}{]}\PY{p}{,}\PY{n}{pole1\PYZus{}MCages}\PY{p}{[}\PY{p}{:}\PY{n}{plotnumber}\PY{p}{]}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{b}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{s}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{pole1\PYZus{}paleolat}\PY{p}{,}\PY{n}{pole1\PYZus{}age}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lightblue}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{edgecolor}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{w}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{pole2\PYZus{}MCpaleolat}\PY{p}{[}\PY{p}{:}\PY{n}{plotnumber}\PY{p}{]}\PY{p}{,}\PY{n}{pole2\PYZus{}MCages}\PY{p}{[}\PY{p}{:}\PY{n}{plotnumber}\PY{p}{]}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{g}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{s}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{pole2\PYZus{}paleolat}\PY{p}{,}\PY{n}{pole2\PYZus{}age}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lightgreen}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{edgecolor}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{w}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{pole1\PYZus{}paleolat}\PY{p}{,}\PY{n}{pole2\PYZus{}paleolat}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{n}{pole1\PYZus{}age}\PY{p}{,}\PY{n}{pole2\PYZus{}age}\PY{p}{]}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{w\PYZhy{}}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{paleolatitude at Duluth, MN (degrees)}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (Ma)}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{pole1\PYZus{}paleolat}\PY{p}{,}\PY{l+m+mi}{1099}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{OVG}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{b}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{ha} \PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{center}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{pole2\PYZus{}paleolat}\PY{p}{,}\PY{l+m+mf}{1104.5}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{NSVG}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{g}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{ha} \PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{center}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{20.5}\PY{p}{,}\PY{l+m+mf}{1092.5}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{A}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{ha} \PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{left}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{pole1\PYZus{}pole2\PYZus{}cm\PYZus{}per\PYZus{}yr}\PY{p}{,}\PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{vlines}\PY{p}{(}\PY{n}{twopointfive\PYZus{}percentile}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{4500}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyles}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dashed}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{twopointfive\PYZus{}percentile}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{4000}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{15 cm/yr}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{ha} \PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{right}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{vlines}\PY{p}{(}\PY{n}{fifty\PYZus{}percentile}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{4500}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyles}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{solid}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{fifty\PYZus{}percentile}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{4000}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{24 cm/yr}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{ha} \PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{left}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{vlines}\PY{p}{(}\PY{n}{ninetysevenpointfive\PYZus{}percentile}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{4500}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyles}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dashed}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{ninetysevenpointfive\PYZus{}percentile}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{4000}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{44 cm/yr}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{ha} \PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{left}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mi}{3930}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{B}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{ha} \PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{left}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{n}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{latitudinal drift rate (cm/yr)}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{4500}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{../2014\PYZus{}Osler\PYZus{}Manuscript\PYZus{}Files/2014\PYZus{}Osler\PYZus{}Figures/MonteCarlo.pdf}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{bbox\PYZus{}inches}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{tight}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_97_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsection{Latitudinal change from early in the early magmatic stage to the main
magmatic stage}


    We can use the pole from the lower third of the Simpson Island
stratigraphy and the pole calculated above from the NSVG to estimate the
magnitude of paleolatitudinal change that occured during the early
magmatic stage, the latent magmatic stage and into the main magmatic
stage. This paleolatitudinal difference is discussed in the manuscript
text.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{lower\PYZus{}Osler\PYZus{}pole}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{218.6}\PY{p}{,}\PY{l+m+mf}{40.9}\PY{p}{)}
         \PY{n}{NSVG\PYZus{}nswu\PYZus{}pole}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{182.1}\PY{p}{,}\PY{l+m+mf}{35.8}\PY{p}{)}
         \PY{n}{lower\PYZus{}Osler\PYZus{}pole\PYZus{}paleolat}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pmag}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{lower\PYZus{}Osler\PYZus{}pole}\PY{p}{,}\PY{n}{Duluth}\PY{p}{)}
         \PY{n}{NSVG\PYZus{}nswu\PYZus{}paleolat}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{pmag}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}pole}\PY{p}{,}\PY{n}{Duluth}\PY{p}{)}
         \PY{n}{difference}\PY{o}{=}\PY{n}{lower\PYZus{}Osler\PYZus{}pole\PYZus{}paleolat}\PY{o}{\PYZhy{}}\PY{n}{NSVG\PYZus{}nswu\PYZus{}paleolat}
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{The difference in paleolatitude resulting from these poles is: }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{difference}\PY{p}{)} 
         \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{from }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{lower\PYZus{}Osler\PYZus{}pole\PYZus{}paleolat}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ to }\PY{l+s}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{NSVG\PYZus{}nswu\PYZus{}paleolat}\PY{p}{)} \PY{o}{+} \PY{l+s}{\PYZsq{}}\PY{l+s}{ using Duluth, MN as a reference location}\PY{l+s}{\PYZsq{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The difference in paleolatitude resulting from these poles is: [ 26.7121489]
from [ 54.5569694] to [ 27.84482051] using Duluth, MN as a reference location
    \end{Verbatim}


    \section{Lava flow thickness data}


    In the section of the text entitled ``Osler Volcanic Group lithologies''
the median flow thickness is reported from the subset of flows within
measured sections where there is sufficient exposure of the flow base,
interior and top to determine thickness. In the text it is reported that
the median flow thickness is 4.9 meters with a first quartile thickness
of 2.0 meters and third quartile thickness of 9.8 meters. The flow
thickness data used in this analysis is presented and analyzed below.
Note that not every flow within the measured stratigraphic sections was
sampled for paleomagnetic analysis and not every flow on Simpson Island
was measured in a stratigraphic section.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{c}{\PYZsh{}flow thicknesses where bottom and top are exposed without cover in between}
         \PY{c}{\PYZsh{}or with minimal cover and assumption of continuity}
         \PY{n}{SI1\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.2}\PY{p}{,} \PY{l+m+mf}{1.1}\PY{o}{+}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{2.9}\PY{o}{+}\PY{l+m+mf}{0.3}\PY{p}{,}\PY{l+m+mf}{5.1}\PY{o}{+}\PY{l+m+mf}{5.4}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mf}{3.4}\PY{p}{,}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{+}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{2.2}\PY{p}{,}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{1.3}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mf}{1.6}\PY{p}{,}\PY{l+m+mf}{0.4}\PY{o}{+}\PY{l+m+mf}{2.3}\PY{p}{,}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{0.8}\PY{o}{+}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.6}\PY{o}{+}\PY{l+m+mf}{0.3}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mf}{2.4}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{4.4}\PY{o}{+}\PY{l+m+mf}{0.8}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{3.3}\PY{o}{+}\PY{l+m+mf}{1.6}\PY{p}{,}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mi}{4}\PY{o}{+}\PY{l+m+mf}{4.7}\PY{o}{+}\PY{l+m+mf}{5.7}\PY{o}{+}\PY{l+m+mf}{1.7}\PY{o}{+}\PY{l+m+mf}{1.8}\PY{p}{,}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{0.8}\PY{o}{+}\PY{l+m+mf}{1.3}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mf}{1.7}\PY{p}{,}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mf}{1.2}\PY{o}{+}\PY{l+m+mf}{0.4}\PY{o}{+}\PY{l+m+mf}{1.3}\PY{p}{,}\PY{l+m+mf}{1.3}\PY{o}{+}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mf}{1.3}\PY{p}{,}\PY{l+m+mf}{2.4}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{1.7}\PY{p}{,}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mf}{0.3}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{o}{+}\PY{o}{.}\PY{l+m+mi}{3}\PY{o}{+}\PY{l+m+mf}{1.3}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{o}{+}\PY{l+m+mf}{1.1}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{o}{+}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{1.3}\PY{p}{,}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{o}{+}\PY{l+m+mf}{1.9}\PY{o}{+}\PY{l+m+mf}{1.7}\PY{o}{+}\PY{l+m+mf}{1.2}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI2\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mf}{2.8}\PY{p}{,}\PY{l+m+mf}{5.7}\PY{o}{+}\PY{l+m+mi}{2}\PY{o}{+}\PY{l+m+mf}{3.6}\PY{p}{,}\PY{l+m+mf}{1.3}\PY{o}{+}\PY{l+m+mf}{0.7}\PY{o}{+}\PY{l+m+mf}{1.1}\PY{o}{+}\PY{l+m+mf}{1.1}\PY{p}{,}\PY{l+m+mf}{6.2}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{1.8}\PY{o}{+}\PY{l+m+mf}{3.3}\PY{o}{+}\PY{l+m+mf}{11.4}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI3\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mf}{0.8}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{+}\PY{o}{.}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mf}{4.9}\PY{o}{+}\PY{l+m+mf}{1.1}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{1.6}\PY{o}{+}\PY{l+m+mf}{4.5}\PY{o}{+}\PY{l+m+mf}{1.2}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{1.5}\PY{o}{+}\PY{l+m+mf}{7.2}\PY{o}{+}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{o}{+}\PY{l+m+mf}{1.7}\PY{o}{+}\PY{l+m+mf}{9.3}\PY{p}{,}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{l+m+mf}{2.9}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{3.1}\PY{o}{+}\PY{l+m+mi}{3}\PY{o}{+}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mf}{3.9}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI4\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{1.2}\PY{o}{+}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{1.5}\PY{o}{+}\PY{l+m+mf}{0.4}\PY{o}{+}\PY{l+m+mf}{3.2}\PY{p}{,}\PY{l+m+mi}{14}\PY{o}{+}\PY{l+m+mf}{6.5}\PY{p}{,}\PY{l+m+mf}{0.7}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mf}{3.6}\PY{p}{,}\PY{l+m+mf}{8.2}\PY{o}{+}\PY{l+m+mf}{2.4}\PY{o}{+}\PY{l+m+mf}{4.6}\PY{p}{,}\PY{l+m+mf}{3.1}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{p}{,}\PY{l+m+mf}{1.6}\PY{p}{,}\PY{l+m+mf}{2.8}\PY{o}{+}\PY{l+m+mf}{2.1}\PY{p}{,}\PY{l+m+mf}{0.7}\PY{o}{+}\PY{l+m+mf}{5.6}\PY{o}{+}\PY{l+m+mf}{2.4}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{5.6}\PY{o}{+}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{2.2}\PY{o}{+}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{0.3}\PY{p}{,}\PY{l+m+mf}{0.4}\PY{o}{+}\PY{l+m+mf}{2.4}\PY{o}{+}\PY{l+m+mf}{1.9}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{4.2}\PY{o}{+}\PY{l+m+mf}{0.7}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI5\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{6.6}\PY{o}{+}\PY{l+m+mf}{9.8}\PY{o}{+}\PY{l+m+mf}{7.4}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{l+m+mf}{2.3}\PY{p}{,}\PY{l+m+mf}{10.2}\PY{o}{+}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mf}{5.6}\PY{o}{+}\PY{l+m+mf}{2.8}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{l+m+mf}{2.2}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{2.8}\PY{o}{+}\PY{l+m+mf}{2.4}\PY{o}{+}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{2.2}\PY{p}{,}\PY{l+m+mf}{1.7}\PY{o}{+}\PY{l+m+mf}{1.7}\PY{p}{,}\PY{l+m+mf}{1.6}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{3.8}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{7.6}\PY{o}{+}\PY{l+m+mf}{20.4}\PY{o}{+}\PY{l+m+mf}{6.3}\PY{o}{+}\PY{l+m+mf}{4.2}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{2.8}\PY{o}{+}\PY{l+m+mf}{1.3}\PY{o}{+}\PY{l+m+mf}{1.2}\PY{p}{,}\PY{l+m+mf}{10.2}\PY{o}{+}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI6\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{13.1}\PY{o}{+}\PY{l+m+mf}{3.3}\PY{p}{,}\PY{l+m+mf}{13.5}\PY{o}{+}\PY{l+m+mf}{3.7}\PY{p}{,}\PY{l+m+mf}{6.5}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{6.1}\PY{o}{+}\PY{l+m+mf}{2.1}\PY{o}{+}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mf}{0.9}\PY{o}{+}\PY{l+m+mf}{6.6}\PY{o}{+}\PY{l+m+mf}{4.0}\PY{p}{,}\PY{l+m+mf}{7.3}\PY{o}{+}\PY{l+m+mf}{5.6}\PY{o}{+}\PY{l+m+mf}{1.3}\PY{o}{+}\PY{l+m+mf}{7.4}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{o}{+}\PY{l+m+mf}{9.6}\PY{o}{+}\PY{l+m+mf}{3.4}\PY{o}{+}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{2.8}\PY{o}{+}\PY{l+m+mf}{4.3}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{7.4}\PY{o}{+}\PY{l+m+mf}{3.9}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI7\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.4}\PY{o}{+}\PY{l+m+mf}{0.9}\PY{o}{+}\PY{l+m+mf}{1.2}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{1.2}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{o}{+}\PY{l+m+mf}{2.5}\PY{o}{+}\PY{l+m+mi}{5}\PY{o}{+}\PY{l+m+mf}{1.9}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI8\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{l+m+mf}{1.9}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mf}{8.8}\PY{o}{+}\PY{l+m+mi}{4}\PY{o}{+}\PY{l+m+mf}{1.1}\PY{p}{,}\PY{l+m+mi}{5}\PY{o}{+}\PY{l+m+mf}{15.8}\PY{o}{+}\PY{l+m+mf}{2.8}\PY{o}{+}\PY{l+m+mf}{2.1}\PY{p}{,}\PY{l+m+mi}{5}\PY{o}{+}\PY{l+m+mf}{4.2}\PY{p}{,}\PY{l+m+mf}{8.4}\PY{o}{+}\PY{l+m+mf}{8.1}\PY{o}{+}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mf}{1.8}\PY{o}{+}\PY{l+m+mf}{11.8}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mf}{2.2}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{p}{]}\PY{p}{)}
         \PY{n}{SI9\PYZus{}flowthickness} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{5.0}\PY{o}{+}\PY{l+m+mf}{4.2}\PY{p}{,}\PY{l+m+mf}{14.0}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mf}{2.1}\PY{p}{,}\PY{l+m+mf}{2.8}\PY{o}{+}\PY{l+m+mf}{2.1}\PY{p}{,}\PY{l+m+mf}{3.6}\PY{o}{+}\PY{l+m+mf}{12.3}\PY{o}{+}\PY{l+m+mf}{3.6}\PY{o}{+}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{4.2}\PY{o}{+}\PY{l+m+mf}{2.3}\PY{p}{,}\PY{l+m+mf}{1.3}\PY{o}{+}\PY{l+m+mf}{1.4}\PY{o}{+}\PY{l+m+mf}{2.2}\PY{p}{,}\PY{l+m+mf}{0.8}\PY{o}{+}\PY{l+m+mf}{1.8}\PY{o}{+}\PY{l+m+mf}{9.8}\PY{o}{+}\PY{l+m+mf}{4.2}\PY{o}{+}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{o}{+}\PY{l+m+mf}{2.0}\PY{o}{+}\PY{l+m+mf}{0.6}\PY{o}{+}\PY{l+m+mf}{2.3}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{o}{+}\PY{l+m+mf}{0.4}\PY{o}{+}\PY{l+m+mf}{3.3}\PY{p}{,}\PY{l+m+mf}{7.5}\PY{p}{]}\PY{p}{)}
             
         \PY{n}{SIall\PYZus{}flowthickness} \PY{o}{=} \PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{SI1\PYZus{}flowthickness}\PY{p}{,} \PY{n}{SI2\PYZus{}flowthickness}\PY{p}{,} 
                                            \PY{n}{SI3\PYZus{}flowthickness}\PY{p}{,} \PY{n}{SI4\PYZus{}flowthickness}\PY{p}{,} 
                                            \PY{n}{SI5\PYZus{}flowthickness}\PY{p}{,} \PY{n}{SI6\PYZus{}flowthickness}\PY{p}{,}
                                            \PY{n}{SI7\PYZus{}flowthickness}\PY{p}{,} \PY{n}{SI8\PYZus{}flowthickness}\PY{p}{,} 
                                            \PY{n}{SI9\PYZus{}flowthickness}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The number of flows for which thickness estimates could be obtained is:}\PY{l+s}{\PYZdq{}}
         \PY{k}{print} \PY{n+nb}{len}\PY{p}{(}\PY{n}{SIall\PYZus{}flowthickness}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The mean flow thickness is:}\PY{l+s}{\PYZdq{}}
         \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{SIall\PYZus{}flowthickness}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The median flow thickness is:}\PY{l+s}{\PYZdq{}}
         \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{n}{SIall\PYZus{}flowthickness}\PY{p}{)}
         
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The first quartile thickness is:}\PY{l+s}{\PYZdq{}}
         \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{SIall\PYZus{}flowthickness}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The third quartile thickness is:}\PY{l+s}{\PYZdq{}}
         \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{SIall\PYZus{}flowthickness}\PY{p}{,}\PY{l+m+mi}{75}\PY{p}{)}
         
         \PY{n}{hist}\PY{p}{(}\PY{n}{SIall\PYZus{}flowthickness}\PY{p}{,} \PY{l+m+mi}{40}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{green}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Histogram of Osler flow thicknesses within measured sections}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{number of flows}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{flow thickness (meters)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         \PY{n}{data}\PY{o}{=}\PY{p}{(}\PY{n}{SI1\PYZus{}flowthickness}\PY{p}{,}\PY{n}{SI2\PYZus{}flowthickness}\PY{p}{,}\PY{n}{SI3\PYZus{}flowthickness}\PY{p}{,}
               \PY{n}{SI4\PYZus{}flowthickness}\PY{p}{,}\PY{n}{SI5\PYZus{}flowthickness}\PY{p}{,} \PY{n}{SI6\PYZus{}flowthickness}\PY{p}{,}
               \PY{n}{SI7\PYZus{}flowthickness}\PY{p}{,}\PY{n}{SI8\PYZus{}flowthickness}\PY{p}{,}\PY{n}{SI9\PYZus{}flowthickness}\PY{p}{,}\PY{n}{SIall\PYZus{}flowthickness}\PY{p}{)}
         
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
         \PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Boxplot of flow thicknesses grouped by stratigraphic section}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{boxplot}\PY{p}{(}\PY{n}{data}\PY{p}{)}
         \PY{n}{labels} \PY{o}{=} \PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{SI1}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{SI2}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{SI3}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{SI4}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{SI5}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{SI6}\PY{l+s}{\PYZsq{}}\PY{p}{,} 
                   \PY{l+s}{\PYZsq{}}\PY{l+s}{SI7}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{SI8}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{SI9}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{all sections}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{stratigraphic section}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{flow thickness (meters)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
The number of flows for which thickness estimates could be obtained is:
105
The mean flow thickness is:
7.16666666667
The median flow thickness is:
4.9
The first quartile thickness is:
2.0
The third quartile thickness is:
9.8
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_103_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{2014_Osler_Data_Analysis_files/2014_Osler_Data_Analysis_103_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \section{The IPmag.py library of functions}


    Some of the functions used in the analysis above come from the imported
IPmag.py library that was developed for this data analysis project
relying heavily on the pmag.py functions developed by Lisa Tauxe. The
code that is within IPmag.py is shown below so that the PDF output of
this IPython notebook can document more of the tools used in the
analysis without the reader needing to look into the .py files
themselves. This library utilizes functions from the pmag.py and
pmagplotlib.py libraries of PmagPy version 2.206.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{o}{\PYZpc{}}\PY{k}{load} \PY{n}{IPmag}\PY{o}{.}\PY{n}{py}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}}]:} \PY{k+kn}{import} \PY{n+nn}{pmag}\PY{o}{,} \PY{n+nn}{pmagplotlib}
       \PY{k+kn}{import} \PY{n+nn}{pylab}
       \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
       \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
       
       \PY{k}{def} \PY{n+nf}{iflip}\PY{p}{(}\PY{n}{D}\PY{p}{)}\PY{p}{:} \PY{c}{\PYZsh{}function simplified from PmagPy pmag.flip function}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    This function returns the antipode (flips) of the unit vectors in D (dec,inc,length).}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{n}{Dflip}\PY{o}{=}\PY{p}{[}\PY{p}{]}
           \PY{k}{for} \PY{n}{rec} \PY{o+ow}{in} \PY{n}{D}\PY{p}{:}
               \PY{n}{d}\PY{p}{,}\PY{n}{i}\PY{o}{=}\PY{p}{(}\PY{n}{rec}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mf}{180.}\PY{p}{)}\PY{o}{\PYZpc{}}\PY{k}{360}\PY{o}{.}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{n}{rec}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
               \PY{n}{Dflip}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{d}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+m+mf}{1.}\PY{p}{]}\PY{p}{)}
           \PY{k}{return} \PY{n}{Dflip}
               
       \PY{k}{def} \PY{n+nf}{iBootstrap}\PY{p}{(}\PY{n}{Data1}\PY{p}{,}\PY{n}{Data2}\PY{p}{,}\PY{n}{NumSims}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    Conduct a bootstrap test (Tauxe, 2010) for a common mean on two declination,}
       \PY{l+s+sd}{    inclination data sets}
       \PY{l+s+sd}{    }
       \PY{l+s+sd}{    This function modifies code from PmagPy for use calculating and plotting }
       \PY{l+s+sd}{    bootstrap statistics. Three plots are generated (one for x, one for y and}
       \PY{l+s+sd}{    one for z). If the 95 percent confidence bounds for each component overlap}
       \PY{l+s+sd}{    each other, the two directions are not significantly different.}
       
       \PY{l+s+sd}{    Parameters}
       \PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
       
       \PY{l+s+sd}{    Data1 : a list of directional data [dec,inc]}
       \PY{l+s+sd}{    Data2 : a list of directional data [dec,inc]}
       \PY{l+s+sd}{    NumSims : number of bootstrap samples (default is 1000)}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}         
           \PY{n}{counter}\PY{o}{=}\PY{l+m+mi}{0}
           \PY{n}{BDI1}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{di\PYZus{}boot}\PY{p}{(}\PY{n}{Data1}\PY{p}{)}
           \PY{n}{BDI2}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{di\PYZus{}boot}\PY{p}{(}\PY{n}{Data2}\PY{p}{)}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{===============}\PY{l+s}{\PYZdq{}}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{Here are the results of the bootstrap test for a common mean}\PY{l+s}{\PYZdq{}}
           \PY{n}{CDF}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{X}\PY{l+s}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Y}\PY{l+s}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{Z}\PY{l+s}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{\PYZcb{}}
           \PY{n}{pylab}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{CDF}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{X}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{160}\PY{p}{)}
           \PY{n}{pylab}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{CDF}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Y}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{160}\PY{p}{)}
           \PY{n}{pylab}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{CDF}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Z}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{160}\PY{p}{)}
           \PY{n}{pmagplotlib}\PY{o}{.}\PY{n}{plotCOM}\PY{p}{(}\PY{n}{CDF}\PY{p}{,}\PY{n}{BDI1}\PY{p}{,}\PY{n}{BDI2}\PY{p}{,}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
           
       \PY{k}{def} \PY{n+nf}{iWatsonV}\PY{p}{(}\PY{n}{Data1}\PY{p}{,}\PY{n}{Data2}\PY{p}{,}\PY{n}{NumSims}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    Conduct a Watson V test for a common mean on two declination, inclination data sets}
       \PY{l+s+sd}{    }
       \PY{l+s+sd}{    This function calculates Watson\PYZsq{}s V statistic from input files through Monte Carlo}
       \PY{l+s+sd}{    simulation in order to test whether two populations of directional data could have}
       \PY{l+s+sd}{    been drawn from a common mean. The critical angle between the two sample mean}
       \PY{l+s+sd}{    directions and the corresponding McFadden and McElhinny (1990) classification is printed.}
       
       
       \PY{l+s+sd}{    Parameters}
       \PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
       
       \PY{l+s+sd}{    Data1 : a list of directional data [dec,inc]}
       \PY{l+s+sd}{    Data2 : a list of directional data [dec,inc]}
       \PY{l+s+sd}{    NumSims : number of Monte Carlo simulations (default is 5000)}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}   
           \PY{n}{pars\PYZus{}1}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{Data1}\PY{p}{)}
           \PY{n}{pars\PYZus{}2}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{Data2}\PY{p}{)}
       
           \PY{n}{cart\PYZus{}1}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{dir2cart}\PY{p}{(}\PY{p}{[}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{dec}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{inc}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
           \PY{n}{cart\PYZus{}2}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{dir2cart}\PY{p}{(}\PY{p}{[}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{r}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
           \PY{n}{Sw}\PY{o}{=}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{c}{\PYZsh{} k1*r1+k2*r2}
           \PY{n}{xhat\PYZus{}1}\PY{o}{=}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{cart\PYZus{}1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{+}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{cart\PYZus{}2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{c}{\PYZsh{} k1*x1+k2*x2}
           \PY{n}{xhat\PYZus{}2}\PY{o}{=}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{cart\PYZus{}1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{cart\PYZus{}2}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{c}{\PYZsh{} k1*y1+k2*y2}
           \PY{n}{xhat\PYZus{}3}\PY{o}{=}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{cart\PYZus{}1}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{+}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{cart\PYZus{}2}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{c}{\PYZsh{} k1*z1+k2*z2}
           \PY{n}{Rw}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{xhat\PYZus{}1}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{+}\PY{n}{xhat\PYZus{}2}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{+}\PY{n}{xhat\PYZus{}3}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
           \PY{n}{V}\PY{o}{=}\PY{l+m+mi}{2}\PY{o}{*}\PY{p}{(}\PY{n}{Sw}\PY{o}{\PYZhy{}}\PY{n}{Rw}\PY{p}{)}
           \PY{c}{\PYZsh{} keep weighted sum for later when determining the \PYZdq{}critical angle\PYZdq{} }
           \PY{c}{\PYZsh{} let\PYZsq{}s save it as Sr (notation of McFadden and McElhinny, 1990)}
           \PY{n}{Sr}\PY{o}{=}\PY{n}{Sw} 
           
           \PY{c}{\PYZsh{} do monte carlo simulation of datasets with same kappas as data, }
           \PY{c}{\PYZsh{} but a common mean}
           \PY{n}{counter}\PY{o}{=}\PY{l+m+mi}{0}
           \PY{n}{Vp}\PY{o}{=}\PY{p}{[}\PY{p}{]} \PY{c}{\PYZsh{} set of Vs from simulations}
           \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{NumSims}\PY{p}{)}\PY{p}{:} 
              
           \PY{c}{\PYZsh{} get a set of N1 fisher distributed vectors with k1,}
           \PY{c}{\PYZsh{} calculate fisher stats}
               \PY{n}{Dirp}\PY{o}{=}\PY{p}{[}\PY{p}{]}
               \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                   \PY{n}{Dirp}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{pmag}\PY{o}{.}\PY{n}{fshdev}\PY{p}{(}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
               \PY{n}{pars\PYZus{}p1}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{Dirp}\PY{p}{)}
           \PY{c}{\PYZsh{} get a set of N2 fisher distributed vectors with k2, }
           \PY{c}{\PYZsh{} calculate fisher stats}
               \PY{n}{Dirp}\PY{o}{=}\PY{p}{[}\PY{p}{]}
               \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                   \PY{n}{Dirp}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{pmag}\PY{o}{.}\PY{n}{fshdev}\PY{p}{(}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{k}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
               \PY{n}{pars\PYZus{}p2}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{fisher\PYZus{}mean}\PY{p}{(}\PY{n}{Dirp}\PY{p}{)}
           \PY{c}{\PYZsh{} get the V for these}
               \PY{n}{Vk}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{vfunc}\PY{p}{(}\PY{n}{pars\PYZus{}p1}\PY{p}{,}\PY{n}{pars\PYZus{}p2}\PY{p}{)}
               \PY{n}{Vp}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Vk}\PY{p}{)}
       
           \PY{c}{\PYZsh{} sort the Vs, get Vcrit (95th percentile one)}
       
           \PY{n}{Vp}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
           \PY{n}{k}\PY{o}{=}\PY{n+nb}{int}\PY{p}{(}\PY{o}{.}\PY{l+m+mi}{95}\PY{o}{*}\PY{n}{NumSims}\PY{p}{)}
           \PY{n}{Vcrit}\PY{o}{=}\PY{n}{Vp}\PY{p}{[}\PY{n}{k}\PY{p}{]}
       
           \PY{c}{\PYZsh{} equation 18 of McFadden and McElhinny, 1990 calculates the critical}
           \PY{c}{\PYZsh{} value of R (Rwc)}
       
           \PY{n}{Rwc}\PY{o}{=}\PY{n}{Sr}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{Vcrit}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
       
           \PY{c}{\PYZsh{} following equation 19 of McFadden and McElhinny (1990) the critical}
           \PY{c}{\PYZsh{} angle is calculated. If the observed angle (also calculated below)}
           \PY{c}{\PYZsh{} between the data set means exceeds the critical angle the hypothesis }
           \PY{c}{\PYZsh{} of a common mean direction may be rejected at the 95\PYZpc{} confidence}
           \PY{c}{\PYZsh{} level. The critical angle is simply a different way to present }
           \PY{c}{\PYZsh{} Watson\PYZsq{}s V parameter so it makes sense to use the Watson V parameter}
           \PY{c}{\PYZsh{} in comparison with the critical value of V for considering the test}
           \PY{c}{\PYZsh{} results. What calculating the critical angle allows for is the }
           \PY{c}{\PYZsh{} classification of McFadden and McElhinny (1990) to be made}
           \PY{c}{\PYZsh{} for data sets that are consistent with sharing a common mean.}
       
           \PY{n}{k1}\PY{o}{=}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}
           \PY{n}{k2}\PY{o}{=}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{]}
           \PY{n}{R1}\PY{o}{=}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{]}
           \PY{n}{R2}\PY{o}{=}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{r}\PY{l+s}{\PYZsq{}}\PY{p}{]}
           \PY{n}{critical\PYZus{}angle}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{degrees}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arccos}\PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{Rwc}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{p}{(}\PY{n}{k1}\PY{o}{*}\PY{n}{R1}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
                                                      \PY{o}{\PYZhy{}}\PY{p}{(}\PY{p}{(}\PY{n}{k2}\PY{o}{*}\PY{n}{R2}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{o}{/}
                                                     \PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{k1}\PY{o}{*}\PY{n}{R1}\PY{o}{*}\PY{n}{k2}\PY{o}{*}\PY{n}{R2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
           \PY{n}{D1}\PY{o}{=}\PY{p}{(}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{pars\PYZus{}1}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
           \PY{n}{D2}\PY{o}{=}\PY{p}{(}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{pars\PYZus{}2}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
           \PY{n}{angle}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{D1}\PY{p}{,}\PY{n}{D2}\PY{p}{)}
       
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{Results of Watson V test: }\PY{l+s}{\PYZdq{}}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}} 
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{Watson}\PY{l+s}{\PYZsq{}}\PY{l+s}{s V:           }\PY{l+s}{\PYZdq{}} \PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.1f}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{V}\PY{p}{)}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{Critical value of V:  }\PY{l+s}{\PYZdq{}} \PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.1f}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Vcrit}\PY{p}{)}
       
           \PY{k}{if} \PY{n}{V}\PY{o}{\PYZlt{}}\PY{n}{Vcrit}\PY{p}{:}
               \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdq{}}\PY{l+s}{Pass}\PY{l+s}{\PYZdq{}}\PY{l+s}{: Since V is less than Vcrit, the null hypothesis}\PY{l+s}{\PYZsq{}}
               \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{that the two populations are drawn from distributions}\PY{l+s}{\PYZsq{}}
               \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{that share a common mean direction can not be rejected.}\PY{l+s}{\PYZsq{}}
           \PY{k}{elif} \PY{n}{V}\PY{o}{\PYZgt{}}\PY{n}{Vcrit}\PY{p}{:}
               \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdq{}}\PY{l+s}{Fail}\PY{l+s}{\PYZdq{}}\PY{l+s}{: Since V is greater than Vcrit, the two means can}\PY{l+s}{\PYZsq{}}
               \PY{k}{print} \PY{l+s}{\PYZsq{}}\PY{l+s}{be distinguished at the 95}\PY{l+s+si}{\PYZpc{} c}\PY{l+s}{onfidence level.}\PY{l+s}{\PYZsq{}}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}    
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{M\PYZam{}M1990 classification:}\PY{l+s}{\PYZdq{}}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}} 
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{Angle between data set means: }\PY{l+s}{\PYZdq{}} \PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.1f}\PY{l+s}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{angle}\PY{p}{)}
           \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{Critical angle for M\PYZam{}M1990:   }\PY{l+s}{\PYZdq{}} \PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.1f}\PY{l+s}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{critical\PYZus{}angle}\PY{p}{)}
           
           \PY{k}{if} \PY{n}{V}\PY{o}{\PYZgt{}}\PY{n}{Vcrit}\PY{p}{:}
               \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}
           \PY{k}{elif} \PY{n}{V}\PY{o}{\PYZlt{}}\PY{n}{Vcrit}\PY{p}{:}
               \PY{k}{if} \PY{n}{critical\PYZus{}angle}\PY{o}{\PYZlt{}}\PY{l+m+mi}{5}\PY{p}{:}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The McFadden and McElhinny (1990) classification for}\PY{l+s}{\PYZdq{}}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{this test is: }\PY{l+s}{\PYZsq{}}\PY{l+s}{A}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdq{}}
               \PY{k}{elif} \PY{n}{critical\PYZus{}angle}\PY{o}{\PYZlt{}}\PY{l+m+mi}{10}\PY{p}{:}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The McFadden and McElhinny (1990) classification for}\PY{l+s}{\PYZdq{}}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{this test is: }\PY{l+s}{\PYZsq{}}\PY{l+s}{B}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdq{}}
               \PY{k}{elif} \PY{n}{critical\PYZus{}angle}\PY{o}{\PYZlt{}}\PY{l+m+mi}{20}\PY{p}{:}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The McFadden and McElhinny (1990) classification for}\PY{l+s}{\PYZdq{}}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{this test is: }\PY{l+s}{\PYZsq{}}\PY{l+s}{C}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdq{}}
               \PY{k}{else}\PY{p}{:}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{The McFadden and McElhinny (1990) classification for}\PY{l+s}{\PYZdq{}}
                   \PY{k}{print} \PY{l+s}{\PYZdq{}}\PY{l+s}{this test is: }\PY{l+s}{\PYZsq{}}\PY{l+s}{INDETERMINATE;}\PY{l+s}{\PYZdq{}}
                   
       \PY{k}{def} \PY{n+nf}{lat\PYZus{}from\PYZus{}i}\PY{p}{(}\PY{n}{inc}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    Calculate paleolatitude from inclination using the dipole equation}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{n}{rad}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{l+m+mf}{180.}
           \PY{n}{paleo\PYZus{}lat}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arctan}\PY{p}{(} \PY{l+m+mf}{0.5}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{tan}\PY{p}{(}\PY{n}{inc}\PY{o}{*}\PY{n}{rad}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{rad}
           \PY{k}{return} \PY{n}{paleo\PYZus{}lat}
       
       
       \PY{k}{def} \PY{n+nf}{iplotDI}\PY{p}{(}\PY{n}{DIblock}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    Plot declination, inclination data on an equal area plot}
       
       \PY{l+s+sd}{    This function modifies the plotDI function of PmagPy for use in the IPython notebook environment}
       
       \PY{l+s+sd}{    Parameters}
       \PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
       
       \PY{l+s+sd}{    DIblock : a DIblock is comprise of a list of unit vectors [dec,inc,1.]}
       \PY{l+s+sd}{    color : the default color is black. Other colors can be chosen (e.g. \PYZsq{}r\PYZsq{})}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{c}{\PYZsh{} initialize the variables}
           \PY{n}{X\PYZus{}down}\PY{p}{,}\PY{n}{X\PYZus{}up}\PY{p}{,}\PY{n}{Y\PYZus{}down}\PY{p}{,}\PY{n}{Y\PYZus{}up}\PY{o}{=}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}
           \PY{k}{for} \PY{n}{rec} \PY{o+ow}{in} \PY{n}{DIblock}\PY{p}{:}
               \PY{n}{Up}\PY{p}{,}\PY{n}{Down}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}
               \PY{n}{XY}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{dimap}\PY{p}{(}\PY{n}{rec}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{rec}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
               \PY{k}{if} \PY{n}{rec}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{0}\PY{p}{:}         
                   \PY{n}{X\PYZus{}down}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{XY}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                   \PY{n}{Y\PYZus{}down}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{XY}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
               \PY{k}{else}\PY{p}{:}
                   \PY{n}{X\PYZus{}up}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{XY}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                   \PY{n}{Y\PYZus{}up}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{XY}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
       
           \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}up}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{:}
               \PY{n}{pylab}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X\PYZus{}up}\PY{p}{,}\PY{n}{Y\PYZus{}up}\PY{p}{,}\PY{n}{facecolors}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{none}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{edgecolors}\PY{o}{=}\PY{n}{color}\PY{p}{)}
       
           \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}down}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{:} 
               \PY{n}{pylab}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X\PYZus{}down}\PY{p}{,}\PY{n}{Y\PYZus{}down}\PY{p}{,}\PY{n}{facecolors}\PY{o}{=}\PY{n}{color}\PY{p}{,} \PY{n}{edgecolors}\PY{o}{=}\PY{n}{color}\PY{p}{)}
       
       \PY{k}{def} \PY{n+nf}{iplotDImean}\PY{p}{(}\PY{n}{Dec}\PY{p}{,}\PY{n}{Inc}\PY{p}{,}\PY{n}{a95}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{o}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    Plot a mean declination, inclination with alpha\PYZus{}95 ellipse on an equal area plot.}
       
       \PY{l+s+sd}{    Before this function is called a plot needs to be initialized with code that looks }
       \PY{l+s+sd}{    something like:}
       \PY{l+s+sd}{    \PYZgt{}fignum = 1}
       \PY{l+s+sd}{    \PYZgt{}pylab.figure(num=fignum,figsize=(10,10),dpi=160)}
       \PY{l+s+sd}{    \PYZgt{}pmagplotlib.plotNET(fignum)}
       
       \PY{l+s+sd}{    Parameters}
       \PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
       
       \PY{l+s+sd}{    Dec : declination of mean being plotted}
       \PY{l+s+sd}{    Inc : inclination of mean being plotted}
       \PY{l+s+sd}{    a95 : a95 confidence ellipse of mean being plotted}
       \PY{l+s+sd}{    color : the default color is black. Other colors can be chosen (e.g. \PYZsq{}r\PYZsq{})}
       \PY{l+s+sd}{    marker : the default is a circle. Other symbols can be chose (e.g. \PYZsq{}s\PYZsq{})}
       \PY{l+s+sd}{    label : the default is no label. Labels can be assigned}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{n}{DI\PYZus{}dimap}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{dimap}\PY{p}{(}\PY{n}{Dec}\PY{p}{,}\PY{n}{Inc}\PY{p}{)}
           \PY{n}{pylab}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{DI\PYZus{}dimap}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{DI\PYZus{}dimap}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{color}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{n}{marker}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{n}{label}\PY{p}{)}
           \PY{n}{Xcirc}\PY{p}{,}\PY{n}{Ycirc}\PY{o}{=}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}
           \PY{n}{Da95}\PY{p}{,}\PY{n}{Ia95}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{circ}\PY{p}{(}\PY{n}{Dec}\PY{p}{,}\PY{n}{Inc}\PY{p}{,}\PY{n}{a95}\PY{p}{)}
           \PY{n}{pylab}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
           \PY{k}{for} \PY{n}{k} \PY{o+ow}{in}  \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{Da95}\PY{p}{)}\PY{p}{)}\PY{p}{:}
               \PY{n}{XY}\PY{o}{=}\PY{n}{pmag}\PY{o}{.}\PY{n}{dimap}\PY{p}{(}\PY{n}{Da95}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{,}\PY{n}{Ia95}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{)}
               \PY{n}{Xcirc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{XY}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
               \PY{n}{Ycirc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{XY}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
           \PY{n}{pylab}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{Xcirc}\PY{p}{,}\PY{n}{Ycirc}\PY{p}{,}\PY{n}{color}\PY{p}{)}
           
       \PY{k}{def} \PY{n+nf}{shoot}\PY{p}{(}\PY{n}{lon}\PY{p}{,} \PY{n}{lat}\PY{p}{,} \PY{n}{azimuth}\PY{p}{,} \PY{n}{maxdist}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    This function enables A95 error ellipses to be drawn in basemap around paleomagnetic}
       \PY{l+s+sd}{    poles in conjunction with equi}
       \PY{l+s+sd}{    (from: http://www.geophysique.be/2011/02/20/matplotlib\PYZhy{}basemap\PYZhy{}tutorial\PYZhy{}09\PYZhy{}drawing\PYZhy{}circles/)}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{n}{glat1} \PY{o}{=} \PY{n}{lat} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{l+m+mf}{180.}
           \PY{n}{glon1} \PY{o}{=} \PY{n}{lon} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{l+m+mf}{180.}
           \PY{n}{s} \PY{o}{=} \PY{n}{maxdist} \PY{o}{/} \PY{l+m+mf}{1.852}
           \PY{n}{faz} \PY{o}{=} \PY{n}{azimuth} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{l+m+mf}{180.}
        
           \PY{n}{EPS}\PY{o}{=} \PY{l+m+mf}{0.00000000005}
           \PY{k}{if} \PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{glat1}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZlt{}}\PY{n}{EPS}\PY{p}{)} \PY{o+ow}{and} \PY{o+ow}{not} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{faz}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZlt{}}\PY{n}{EPS}\PY{p}{)}\PY{p}{)}\PY{p}{:}
               \PY{n}{alert}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Only N\PYZhy{}S courses are meaningful, starting at a pole!}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        
           \PY{n}{a}\PY{o}{=}\PY{l+m+mf}{6378.13}\PY{o}{/}\PY{l+m+mf}{1.852}
           \PY{n}{f}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mf}{298.257223563}
           \PY{n}{r} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{f}
           \PY{n}{tu} \PY{o}{=} \PY{n}{r} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{tan}\PY{p}{(}\PY{n}{glat1}\PY{p}{)}
           \PY{n}{sf} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{faz}\PY{p}{)}
           \PY{n}{cf} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{faz}\PY{p}{)}
           \PY{k}{if} \PY{p}{(}\PY{n}{cf}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
               \PY{n}{b}\PY{o}{=}\PY{l+m+mf}{0.}
           \PY{k}{else}\PY{p}{:}
               \PY{n}{b}\PY{o}{=}\PY{l+m+mf}{2.} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{arctan2} \PY{p}{(}\PY{n}{tu}\PY{p}{,} \PY{n}{cf}\PY{p}{)}
        
           \PY{n}{cu} \PY{o}{=} \PY{l+m+mf}{1.} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{tu} \PY{o}{*} \PY{n}{tu}\PY{p}{)}
           \PY{n}{su} \PY{o}{=} \PY{n}{tu} \PY{o}{*} \PY{n}{cu}
           \PY{n}{sa} \PY{o}{=} \PY{n}{cu} \PY{o}{*} \PY{n}{sf}
           \PY{n}{c2a} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{sa} \PY{o}{*} \PY{n}{sa}
           \PY{n}{x} \PY{o}{=} \PY{l+m+mf}{1.} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mf}{1.} \PY{o}{+} \PY{n}{c2a} \PY{o}{*} \PY{p}{(}\PY{l+m+mf}{1.} \PY{o}{/} \PY{p}{(}\PY{n}{r} \PY{o}{*} \PY{n}{r}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mf}{1.}\PY{p}{)}\PY{p}{)}
           \PY{n}{x} \PY{o}{=} \PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{l+m+mf}{2.}\PY{p}{)} \PY{o}{/} \PY{n}{x}
           \PY{n}{c} \PY{o}{=} \PY{l+m+mf}{1.} \PY{o}{\PYZhy{}} \PY{n}{x}
           \PY{n}{c} \PY{o}{=} \PY{p}{(}\PY{n}{x} \PY{o}{*} \PY{n}{x} \PY{o}{/} \PY{l+m+mf}{4.} \PY{o}{+} \PY{l+m+mf}{1.}\PY{p}{)} \PY{o}{/} \PY{n}{c}
           \PY{n}{d} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{0.375} \PY{o}{*} \PY{n}{x} \PY{o}{*} \PY{n}{x} \PY{o}{\PYZhy{}} \PY{l+m+mf}{1.}\PY{p}{)} \PY{o}{*} \PY{n}{x}
           \PY{n}{tu} \PY{o}{=} \PY{n}{s} \PY{o}{/} \PY{p}{(}\PY{n}{r} \PY{o}{*} \PY{n}{a} \PY{o}{*} \PY{n}{c}\PY{p}{)}
           \PY{n}{y} \PY{o}{=} \PY{n}{tu}
           \PY{n}{c} \PY{o}{=} \PY{n}{y} \PY{o}{+} \PY{l+m+mi}{1}
           \PY{k}{while} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs} \PY{p}{(}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{c}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{EPS}\PY{p}{)}\PY{p}{:}
        
               \PY{n}{sy} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{y}\PY{p}{)}
               \PY{n}{cy} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{y}\PY{p}{)}
               \PY{n}{cz} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{b} \PY{o}{+} \PY{n}{y}\PY{p}{)}
               \PY{n}{e} \PY{o}{=} \PY{l+m+mf}{2.} \PY{o}{*} \PY{n}{cz} \PY{o}{*} \PY{n}{cz} \PY{o}{\PYZhy{}} \PY{l+m+mf}{1.}
               \PY{n}{c} \PY{o}{=} \PY{n}{y}
               \PY{n}{x} \PY{o}{=} \PY{n}{e} \PY{o}{*} \PY{n}{cy}
               \PY{n}{y} \PY{o}{=} \PY{n}{e} \PY{o}{+} \PY{n}{e} \PY{o}{\PYZhy{}} \PY{l+m+mf}{1.}
               \PY{n}{y} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{sy} \PY{o}{*} \PY{n}{sy} \PY{o}{*} \PY{l+m+mf}{4.} \PY{o}{\PYZhy{}} \PY{l+m+mf}{3.}\PY{p}{)} \PY{o}{*} \PY{n}{y} \PY{o}{*} \PY{n}{cz} \PY{o}{*} \PY{n}{d} \PY{o}{/} \PY{l+m+mf}{6.} \PY{o}{+} \PY{n}{x}\PY{p}{)} \PY{o}{*}
                     \PY{n}{d} \PY{o}{/} \PY{l+m+mf}{4.} \PY{o}{\PYZhy{}} \PY{n}{cz}\PY{p}{)} \PY{o}{*} \PY{n}{sy} \PY{o}{*} \PY{n}{d} \PY{o}{+} \PY{n}{tu}
        
           \PY{n}{b} \PY{o}{=} \PY{n}{cu} \PY{o}{*} \PY{n}{cy} \PY{o}{*} \PY{n}{cf} \PY{o}{\PYZhy{}} \PY{n}{su} \PY{o}{*} \PY{n}{sy}
           \PY{n}{c} \PY{o}{=} \PY{n}{r} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{sa} \PY{o}{*} \PY{n}{sa} \PY{o}{+} \PY{n}{b} \PY{o}{*} \PY{n}{b}\PY{p}{)}
           \PY{n}{d} \PY{o}{=} \PY{n}{su} \PY{o}{*} \PY{n}{cy} \PY{o}{+} \PY{n}{cu} \PY{o}{*} \PY{n}{sy} \PY{o}{*} \PY{n}{cf}
           \PY{n}{glat2} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arctan2}\PY{p}{(}\PY{n}{d}\PY{p}{,} \PY{n}{c}\PY{p}{)} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{pi}
           \PY{n}{c} \PY{o}{=} \PY{n}{cu} \PY{o}{*} \PY{n}{cy} \PY{o}{\PYZhy{}} \PY{n}{su} \PY{o}{*} \PY{n}{sy} \PY{o}{*} \PY{n}{cf}
           \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arctan2}\PY{p}{(}\PY{n}{sy} \PY{o}{*} \PY{n}{sf}\PY{p}{,} \PY{n}{c}\PY{p}{)}
           \PY{n}{c} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.} \PY{o}{*} \PY{n}{c2a} \PY{o}{+} \PY{l+m+mf}{4.}\PY{p}{)} \PY{o}{*} \PY{n}{f} \PY{o}{+} \PY{l+m+mf}{4.}\PY{p}{)} \PY{o}{*} \PY{n}{c2a} \PY{o}{*} \PY{n}{f} \PY{o}{/} \PY{l+m+mf}{16.}
           \PY{n}{d} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{e} \PY{o}{*} \PY{n}{cy} \PY{o}{*} \PY{n}{c} \PY{o}{+} \PY{n}{cz}\PY{p}{)} \PY{o}{*} \PY{n}{sy} \PY{o}{*} \PY{n}{c} \PY{o}{+} \PY{n}{y}\PY{p}{)} \PY{o}{*} \PY{n}{sa}
           \PY{n}{glon2} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{glon1} \PY{o}{+} \PY{n}{x} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m+mf}{1.} \PY{o}{\PYZhy{}} \PY{n}{c}\PY{p}{)} \PY{o}{*} \PY{n}{d} \PY{o}{*} \PY{n}{f} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{pi}    
        
           \PY{n}{baz} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arctan2}\PY{p}{(}\PY{n}{sa}\PY{p}{,} \PY{n}{b}\PY{p}{)} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}
        
           \PY{n}{glon2} \PY{o}{*}\PY{o}{=} \PY{l+m+mf}{180.}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}
           \PY{n}{glat2} \PY{o}{*}\PY{o}{=} \PY{l+m+mf}{180.}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}
           \PY{n}{baz} \PY{o}{*}\PY{o}{=} \PY{l+m+mf}{180.}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}
        
           \PY{k}{return} \PY{p}{(}\PY{n}{glon2}\PY{p}{,} \PY{n}{glat2}\PY{p}{,} \PY{n}{baz}\PY{p}{)}
       
       \PY{k}{def} \PY{n+nf}{equi}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{centerlon}\PY{p}{,} \PY{n}{centerlat}\PY{p}{,} \PY{n}{radius}\PY{p}{,} \PY{n}{color}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    This function enables A95 error ellipses to be drawn in basemap around paleomagnetic poles}
       \PY{l+s+sd}{    in conjunction with shoot}
       \PY{l+s+sd}{    (from: http://www.geophysique.be/2011/02/20/matplotlib\PYZhy{}basemap\PYZhy{}tutorial\PYZhy{}09\PYZhy{}drawing\PYZhy{}circles/).}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{n}{glon1} \PY{o}{=} \PY{n}{centerlon}
           \PY{n}{glat1} \PY{o}{=} \PY{n}{centerlat}
           \PY{n}{X} \PY{o}{=} \PY{p}{[}\PY{p}{]}
           \PY{n}{Y} \PY{o}{=} \PY{p}{[}\PY{p}{]}
           \PY{k}{for} \PY{n}{azimuth} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{360}\PY{p}{)}\PY{p}{:}
               \PY{n}{glon2}\PY{p}{,} \PY{n}{glat2}\PY{p}{,} \PY{n}{baz} \PY{o}{=} \PY{n}{shoot}\PY{p}{(}\PY{n}{glon1}\PY{p}{,} \PY{n}{glat1}\PY{p}{,} \PY{n}{azimuth}\PY{p}{,} \PY{n}{radius}\PY{p}{)}
               \PY{n}{X}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{glon2}\PY{p}{)}
               \PY{n}{Y}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{glat2}\PY{p}{)}
           \PY{n}{X}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
           \PY{n}{Y}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Y}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
           \PY{n}{X}\PY{p}{,}\PY{n}{Y} \PY{o}{=} \PY{n}{m}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{)}
           \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{color}\PY{p}{)}
       
       \PY{k}{def} \PY{n+nf}{poleplot}\PY{p}{(}\PY{n}{mapname}\PY{p}{,}\PY{n}{plong}\PY{p}{,}\PY{n}{plat}\PY{p}{,}\PY{n}{A95}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{o}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    This function plots a paleomagnetic pole and A95 error ellipse on whatever }
       \PY{l+s+sd}{    current map projection has been set using the basemap plotting library.}
       
       \PY{l+s+sd}{    Parameters}
       \PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
       \PY{l+s+sd}{    mapname : the name of the current map that has been developed using basemap}
       \PY{l+s+sd}{    plong : the longitude of the paleomagnetic pole being plotted (in degrees E)}
       \PY{l+s+sd}{    plat : the latitude of the paleomagnetic pole being plotted (in degrees)}
       \PY{l+s+sd}{    A95 : the A\PYZus{}95 confidence ellipse of the paleomagnetic pole (in degrees)}
       \PY{l+s+sd}{    label : a string that is the label for the paleomagnetic pole being plotted}
       \PY{l+s+sd}{    color : the color desired for the symbol and its A95 ellipse (default is \PYZsq{}k\PYZsq{} aka black)}
       \PY{l+s+sd}{    marker : the marker shape desired for the pole mean symbol (default is \PYZsq{}o\PYZsq{} aka a circle)}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{n}{centerlon}\PY{p}{,} \PY{n}{centerlat} \PY{o}{=} \PY{n}{mapname}\PY{p}{(}\PY{n}{plong}\PY{p}{,}\PY{n}{plat}\PY{p}{)}
           \PY{n}{A95\PYZus{}km}\PY{o}{=}\PY{n}{A95}\PY{o}{*}\PY{l+m+mf}{111.32}
           \PY{n}{mapname}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{centerlon}\PY{p}{,}\PY{n}{centerlat}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{n}{marker}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{color}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{n}{label}\PY{p}{,}\PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{101}\PY{p}{)}
           \PY{n}{equi}\PY{p}{(}\PY{n}{mapname}\PY{p}{,} \PY{n}{plong}\PY{p}{,} \PY{n}{plat}\PY{p}{,} \PY{n}{A95\PYZus{}km}\PY{p}{,}\PY{n}{color}\PY{p}{)}
       
       \PY{k}{def} \PY{n+nf}{vgpplot}\PY{p}{(}\PY{n}{mapname}\PY{p}{,}\PY{n}{plong}\PY{p}{,}\PY{n}{plat}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{o}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    This function plots a paleomagnetic pole on whatever current map projection}
       \PY{l+s+sd}{    has been set using the basemap plotting library.}
       
       \PY{l+s+sd}{    Parameters}
       \PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
       \PY{l+s+sd}{    mapname : the name of the current map that has been developed using basemap}
       \PY{l+s+sd}{    plong : the longitude of the paleomagnetic pole being plotted (in degrees E)}
       \PY{l+s+sd}{    plat : the latitude of the paleomagnetic pole being plotted (in degrees)}
       \PY{l+s+sd}{    color : the color desired for the symbol and its A95 ellipse (default is \PYZsq{}k\PYZsq{} aka black)}
       \PY{l+s+sd}{    marker : the marker shape desired for the pole mean symbol (default is \PYZsq{}o\PYZsq{} aka a circle)}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{n}{centerlon}\PY{p}{,} \PY{n}{centerlat} \PY{o}{=} \PY{n}{mapname}\PY{p}{(}\PY{n}{plong}\PY{p}{,}\PY{n}{plat}\PY{p}{)}
           \PY{n}{mapname}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{centerlon}\PY{p}{,}\PY{n}{centerlat}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{n}{marker}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{color}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{n}{label}\PY{p}{,}\PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
       
       \PY{k}{def} \PY{n+nf}{VGP\PYZus{}calc}\PY{p}{(}\PY{n}{dataframe}\PY{p}{)}\PY{p}{:}
           \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{l+s+sd}{    This function calculates paleomagnetic poles from directional data within a pandas.DataFrame}
       
       \PY{l+s+sd}{    Parameters}
       \PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} }
       \PY{l+s+sd}{    dataframe : the name of the pandas.DataFrame containing the data}
       \PY{l+s+sd}{    dataframe[\PYZsq{}site\PYZus{}lat\PYZsq{}] : the latitude of the site}
       \PY{l+s+sd}{    dataframe[\PYZsq{}site\PYZus{}long\PYZsq{}] : the longitude of the site}
       \PY{l+s+sd}{    dataframe[\PYZsq{}inc\PYZus{}tc\PYZsq{}] : the tilt\PYZhy{}corrected inclination }
       \PY{l+s+sd}{    dataframe[\PYZsq{}dec\PYZus{}tc\PYZsq{}] : the tilt\PYZhy{}corrected declination}
       \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
           \PY{c}{\PYZsh{}calculate the paleolatitude/colatitude}
           \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{paleolatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{degrees}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arctan}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{tan}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{inc\PYZus{}tc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
           \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{colatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{90}\PY{o}{\PYZhy{}}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{paleolatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}
           \PY{c}{\PYZsh{}calculate the latitude of the pole}
           \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{degrees}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arcsin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{site\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{*}
                                                                \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{colatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{+}
                                                                \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{site\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{*}
                                                                \PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{colatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{*}
                                                                \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec\PYZus{}tc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
           \PY{c}{\PYZsh{}calculate the longitudinal difference between the pole and the site (beta)}
           \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{beta}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{degrees}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arcsin}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{colatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{*}
                                             \PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dec\PYZus{}tc}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{/}
                                            \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
           \PY{c}{\PYZsh{}generate a boolean array (mask) to use to distinguish between the two possibilities for pole longitude}
           \PY{c}{\PYZsh{}and then calculate pole longitude using the site location and calculated beta}
           \PY{n}{mask} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{colatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{site\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{radians}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
           \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}long}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{mask}\PY{p}{,}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{site\PYZus{}long}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{beta}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{\PYZpc{}}\PY{k}{360}\PY{o}{.}\PY{p}{,}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{site\PYZus{}long}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{180}\PY{o}{\PYZhy{}}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{beta}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{\PYZpc{}}\PY{k}{360}\PY{o}{.}\PY{p}{)}
           \PY{c}{\PYZsh{}calculate the antipode of the poles}
           \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}lat\PYZus{}rev}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}lat}\PY{l+s}{\PYZsq{}}\PY{p}{]}
           \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}long\PYZus{}rev}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{p}{(}\PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pole\PYZus{}long}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mf}{180.}\PY{p}{)}\PY{o}{\PYZpc{}}\PY{k}{360}\PY{o}{.} 
           \PY{c}{\PYZsh{}the \PYZsq{}colatitude\PYZsq{} and \PYZsq{}beta\PYZsq{} columns were created for the purposes of the pole calculations}
           \PY{c}{\PYZsh{}but aren\PYZsq{}t of further use and are deleted}
           \PY{k}{del} \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{colatitude}\PY{l+s}{\PYZsq{}}\PY{p}{]}
           \PY{k}{del} \PY{n}{dataframe}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{beta}\PY{l+s}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
